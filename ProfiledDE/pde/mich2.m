function pdemodel
[pde_fig,ax]=pdeinit;
pdetool('appl_cb',1);
set(ax,'DataAspectRatio',[3 2 1]);
set(ax,'PlotBoxAspectRatio',[1 1 1]);
set(ax,'XLim',[-1.5 1.5]);
set(ax,'YLim',[-1 1]);
set(ax,'XTick',[ -1,...
 -0.80000000000000004,...
 -0.59999999999999998,...
 -0.39999999999999991,...
 -0.19999999999999996,...
 0,...
 0.19999999999999996,...
 0.39999999999999991,...
 0.59999999999999998,...
 0.80000000000000004,...
 1,...
]);
set(ax,'YTickMode','auto');

% Geometry description:
pdepoly([ -0.39591836734693864,...
 -0.60408163265306114,...
 -0.80000000000000004,...
 -0.99591836734693873,...
 -0.79591836734693877,...
 -0.45714285714285707,...
 -0.39999999999999991,...
 -0.40408163265306118,...
 -0.23673469387755097,...
 -0.19183673469387741,...
 0,...
 0.20408163265306123,...
 0.37142857142857166,...
 0.40000000000000013,...
 0.28979591836734708,...
 0.2081632653061225,...
 0.13469387755102047,...
 0.048979591836734837,...
 0.0040816326530612734,...
 0.0081632653061225469,...
 0.106122448979592,...
 0.1306122448979592,...
 0.0040816326530612734,...
 0.50612244897959213,...
 0.51428571428571468,...
 0.82040816326530663,...
 1.0000000000000004,...
 1.0040816326530617,...
 1.0000000000000004,...
 0.89795918367346994,...
 0.80000000000000027,...
 0.7551020408163267,...
 0.64081632653061282,...
 0.80000000000000027,...
 0.80000000000000027,...
 0.77551020408163307,...
 0.60816326530612264,...
 0.43265306122448988,...
 0.40816326530612268,...
 0.54285714285714315,...
 0.40408163265306141,...
 0.33061224489795937,...
 0.29795918367346963,...
 0.20408163265306123,...
 0.0040816326530612734,...
 -0.061224489795918213,...
 -0.25306122448979584,...
 -0.39183673469387759,...
 -0.55102040816326525,...
 -0.53877551020408165,...
],...
[ 0.93469387755102051,...
 0.82040816326530619,...
 0.74285714285714288,...
 0.60408163265306136,...
 0.49387755102040831,...
 0.40408163265306118,...
 0.3387755102040817,...
 0.22857142857142865,...
 0.19999999999999996,...
 0.3387755102040817,...
 0.416326530612245,...
 0.53877551020408165,...
 0.46122448979591857,...
 0.40408163265306118,...
 0.34693877551020424,...
 0.21224489795918378,...
 0.085714285714285854,...
 -0.0040816326530612734,...
 -0.18367346938775508,...
 -0.37959183673469399,...
 -0.60000000000000009,...
 -0.79591836734693899,...
 -0.99183673469387745,...
 -0.97142857142857153,...
 -0.99183673469387745,...
 -0.95102040816326516,...
 -0.64897959183673493,...
 -0.40408163265306118,...
 -0.19183673469387763,...
 -0.12653061224489792,...
 -0.19591836734693868,...
 -0.28979591836734686,...
 -0.20408163265306123,...
 -0.0040816326530612734,...
 0.15510204081632661,...
 0.23673469387755097,...
 0.35918367346938784,...
 0.41224489795918373,...
 0.46938775510204089,...
 0.54285714285714293,...
 0.6775510204081634,...
 0.62857142857142856,...
 0.71020408163265314,...
 0.6775510204081634,...
 0.67346938775510212,...
 0.60408163265306136,...
 0.60000000000000009,...
 0.71836734693877569,...
 0.72244897959183696,...
 0.80408163265306132,...
],...
 'P1');
set(findobj(get(pde_fig,'Children'),'Tag','PDEEval'),'String','P1')

% Boundary conditions:
pdetool('changemode',0)
pdesetbd(50,...
'neu',...
1,...
'0',...
'0')
pdesetbd(49,...
'neu',...
1,...
'0',...
'0')
pdesetbd(48,...
'neu',...
1,...
'0',...
'0')
pdesetbd(47,...
'neu',...
1,...
'0',...
'0')
pdesetbd(46,...
'neu',...
1,...
'0',...
'0')
pdesetbd(45,...
'neu',...
1,...
'0',...
'0')
pdesetbd(44,...
'neu',...
1,...
'0',...
'0')
pdesetbd(43,...
'neu',...
1,...
'0',...
'0')
pdesetbd(42,...
'neu',...
1,...
'0',...
'0')
pdesetbd(41,...
'neu',...
1,...
'0',...
'0')
pdesetbd(40,...
'neu',...
1,...
'0',...
'0')
pdesetbd(39,...
'neu',...
1,...
'0',...
'0')
pdesetbd(38,...
'neu',...
1,...
'0',...
'0')
pdesetbd(37,...
'neu',...
1,...
'0',...
'0')
pdesetbd(36,...
'neu',...
1,...
'0',...
'0')
pdesetbd(35,...
'neu',...
1,...
'0',...
'0')
pdesetbd(34,...
'neu',...
1,...
'0',...
'0')
pdesetbd(33,...
'neu',...
1,...
'0',...
'0')
pdesetbd(32,...
'neu',...
1,...
'0',...
'0')
pdesetbd(31,...
'neu',...
1,...
'0',...
'0')
pdesetbd(30,...
'neu',...
1,...
'0',...
'0')
pdesetbd(29,...
'neu',...
1,...
'0',...
'0')
pdesetbd(28,...
'neu',...
1,...
'0',...
'0')
pdesetbd(27,...
'neu',...
1,...
'0',...
'0')
pdesetbd(26,...
'neu',...
1,...
'0',...
'0')
pdesetbd(25,...
'neu',...
1,...
'0',...
'0')
pdesetbd(24,...
'neu',...
1,...
'0',...
'0')
pdesetbd(23,...
'neu',...
1,...
'0',...
'0')
pdesetbd(22,...
'neu',...
1,...
'0',...
'0')
pdesetbd(21,...
'neu',...
1,...
'0',...
'0')
pdesetbd(20,...
'neu',...
1,...
'0',...
'0')
pdesetbd(19,...
'neu',...
1,...
'0',...
'0')
pdesetbd(18,...
'neu',...
1,...
'0',...
'0')
pdesetbd(17,...
'neu',...
1,...
'0',...
'0')
pdesetbd(16,...
'neu',...
1,...
'0',...
'0')
pdesetbd(15,...
'neu',...
1,...
'0',...
'0')
pdesetbd(14,...
'neu',...
1,...
'0',...
'0')
pdesetbd(13,...
'neu',...
1,...
'0',...
'0')
pdesetbd(12,...
'neu',...
1,...
'0',...
'0')
pdesetbd(11,...
'neu',...
1,...
'0',...
'0')
pdesetbd(10,...
'neu',...
1,...
'0',...
'0')
pdesetbd(9,...
'neu',...
1,...
'0',...
'0')
pdesetbd(8,...
'neu',...
1,...
'0',...
'0')
pdesetbd(7,...
'neu',...
1,...
'0',...
'0')
pdesetbd(6,...
'neu',...
1,...
'0',...
'0')
pdesetbd(5,...
'neu',...
1,...
'0',...
'0')
pdesetbd(4,...
'neu',...
1,...
'0',...
'0')
pdesetbd(3,...
'neu',...
1,...
'0',...
'0')
pdesetbd(2,...
'neu',...
1,...
'0',...
'0')
pdesetbd(1,...
'neu',...
1,...
'0',...
'0')

% Mesh generation:
setuprop(pde_fig,'Hgrad',1.3);
setuprop(pde_fig,'refinemethod','regular');
pdetool('initmesh')

% PDE coefficients:
pdeseteq(2,...
'1.0',...
'0.0',...
'0',...
'20',...
'0:.05:2',...
'cos(2*pi*sqrt(x.^2+y.^2)).*sin(atan2(y,x))',...
'0.0',...
'[0 100]')
setuprop(pde_fig,'currparam',...
['1.0';...
'0.0';...
'0  ';...
'20 '])

% Solve parameters:
setuprop(pde_fig,'solveparam',...
str2mat('0','1000','10','pdeadworst',...
'0.5','longest','0','1E-4','','fixed','Inf'))

% Plotflags and user data strings:
%setuprop(pde_fig,'plotflags',[1 1 1 1 1 1 6 1 0 0 1 41 1 0 0 0 0 1]);
setuprop(pde_fig,'plotflags',[1 1 1 1 1 1 6 1 0 0 0 41 1 0 0 1 0 1]);
setuprop(pde_fig,'colstring','');
setuprop(pde_fig,'arrowstring','');
setuprop(pde_fig,'deformstring','');
setuprop(pde_fig,'heightstring','');

% Solve PDE:
pdetool('solve')
