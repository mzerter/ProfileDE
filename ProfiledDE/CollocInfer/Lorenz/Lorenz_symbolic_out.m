%  ------------------------------------------------------------------------
%                   derivatives of f's wrt y's
%  ------------------------------------------------------------------------

% y1

dfdxval(:,1,1) = -p3;
dfdxval(:,1,2) =  p2 + y3;
dfdxval(:,1,3) =  y2;

% y2

dfdxval(:,2,1) =  p3;
dfdxval(:,2,2) = -1;
dfdxval(:,2,3) =  y1;

% y3

dfdxval(:,3,1) =  0;
dfdxval(:,3,2) =  y1;
dfdxval(:,3,3) = -p3;

%  ------------------------------------------------------------------------
%     second derivatives of three functions wrt three y's 
%  ------------------------------------------------------------------------

% y1-y1
0
0
0

% y2-y1
0
0
d2fdx2val(:,3,2,1) = 1;

% y3-y1
0
d2fdx2val(:,2,3,1) = 1; 
0

% y1-y2
0
0
d2fdx2val(:,3,1,2) = 1;

% y2-y2
0
0
0

% y3-y2
0
0
0


% y1-y3
0
d2fdx2val(:,2,1,3) = 1;
0

%
% y2-y3
0
0
0

% y3-y3
0
0
0 

%  ------------------------------------------------------------------------
%                   derivatives of f's wrt the 3 p's
%  ------------------------------------------------------------------------

% p1

0 
0
0

% p2

0 
dfdpval(:,2,2) =  y1;
0

% p3

dfdpval(:,1,3) =  y2 - y1;
0
dfdpval(:,3,3) = -y3;


%  ------------------------------------------------------------------------
%     second derivatives of f's wrt y's and wrt last 14 p's
%  ------------------------------------------------------------------------

% y1-p1
0
0
0

% y2-p1
0
0
0

% y3-p1
0
0
0


% y1-p2
0
d2fdxdpval(:,2,1,2) = 1;
0

% y2-p2
0
0
0

% y3-p2
0
0
0



% y1-p3
d2fdxdpval(:,1,1,3) = -1;
0
0

% y2-p3
d2fdxdpval(:,1,2,3) =  1;
0
0

% y3-p3
0
0
d2fdxdpval(:,3,3,3) = -1;


