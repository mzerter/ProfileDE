function dfdpval = chemo_dfdp(times, y, logp)

p = exp(logp);

[nt, ny] = size(y);  np = length(p);

p3  = p(3);
p4  = p(4);
p5  = p(5);
p6  = p(6);
p9  = p(9);
p10 = p(10);
p11 = p(11);
p12 = p(12);
p13 = p(13);
p14 = p(14);
p15 = p(15);
p16 = p(16);

y1 = y(:,1);
y2 = y(:,2);
y3 = y(:,3);
y4 = y(:,4);
y5 = y(:,5);

p10py1  = p10 + y1;
p11py1  = p11 + y1;

E10 = exp( 100*p3*y2 - 100*p16 + 100*p4*y3);
E11 = exp( 200*p3*y2 - 200*p16 + 200*p4*y3);
E15 = exp( 100*p16 - 100*p3*y2 - 100*p4*y3);

E10p1 = E10 + 1;
E11p1 = E11 + 1;
E15p1 = E15 + 1;

dfdpval = zeros(nt,ny,np);

dfdpval(:,2,3) = -(E10*(2*p13*p15*y2*(y4 + y5) + p13*y2*(y4 + y5)*(p16 - 100*p3^2*y2^2 + p4*y3 + 100*p16*p3*y2 - 100*p3*p4*y2*y3)) + p13*y2*(p16 + p4*y3*E11)*(y4 + y5) + p13*p15*y2*(y4 + y5)*E11p1)/(p15 + p16 + p15*E10 + p3*y2*E10 + p4*y3*E10)^2;
dfdpval(:,3,3) =  (p13*p4*y3*(y4 + y5)*((y2*E10)/E10p1 + (100*y2*E10*(p3*y2 + p4*y3))/E10p1 - (100*y2*E11*(p3*y2 + p4*y3))/E10p1^2) - (100*p13*p16*p4*y2*y3*E10*(y4 + y5))/E10p1^2)/(p15 + p16/E10p1 + (E10*(p3*y2 + p4*y3))/E10p1)^2;
dfdpval(:,4,3) =  (E10*(2*p13*p14*p15*y2*y4 - p13*p14*y2*y4*(100*p3^2*y2^2 + 200*p3*p4*y2*y3 + 100*p4^2*y3^2) + p13*p14*p16*y2*y4*(100*p3*y2 + 100*p4*y3 + 1)) + p13*p14*p16*y2*y4 + p13*p14*p15*y2*y4*E11p1)/(p15 + p16 + p15*E10 + p3*y2*E10 + p4*y3*E10)^2;

dfdpval(:,2,4) =  (p13*p3*y2*(y4 + y5)*((y3*E10)/E10p1 + (100*y3*E10*(p3*y2 + p4*y3))/E10p1 - (100*y3*E11*(p3*y2 + p4*y3))/E10p1^2) - (100*p13*p16*p3*y2*y3*E10*(y4 + y5))/E10p1^2)/(p15 + p16/E10p1 + (E10*(p3*y2 + p4*y3))/E10p1)^2;
dfdpval(:,3,4) = -(E10*(2*p13*p15*y3*(y4 + y5) + p13*y3*(y4 + y5)*(p16 - 100*p4^2*y3^2 + p3*y2 + 100*p16*p4*y3 - 100*p3*p4*y2*y3)) + p13*y3*(p16 + p3*y2*E11)*(y4 + y5) + p13*p15*y3*(y4 + y5)*E11p1)/(p15 + p16 + p15*E10 + p3*y2*E10 + p4*y3*E10)^2;
dfdpval(:,4,4) =  (E10*(2*p13*p14*p15*y3*y4 - p13*p14*y3*y4*(100*p3^2*y2^2 + 200*p3*p4*y2*y3 + 100*p4^2*y3^2) + p13*p14*p16*y3*y4*(100*p3*y2 + 100*p4*y3 + 1)) + p13*p14*p16*y3*y4 + p13*p14*p15*y3*y4*E11p1)/(p15 + p16 + p15*E10 + p3*y2*E10 + p4*y3*E10)^2;

dfdpval(:,1,5) = p6;

dfdpval(:,1,6) = p5 - y1;
dfdpval(:,2,6) = -y2;
dfdpval(:,3,6) = -y3;
dfdpval(:,4,6) = -y4;
dfdpval(:,5,6) = -y5;

dfdpval(:,4,7) = -y4;
dfdpval(:,5,7) = -y5;

dfdpval(:,4,8) = -y4;
dfdpval(:,5,8) =  y4;

dfdpval(:,2,9) = (p12*y1*y2)/p10py1;
dfdpval(:,3,9) = (p12*y1*y3)/p11py1;

dfdpval(:,1,10) = (p12*y1*y2)/p10py1^2;
dfdpval(:,2,10) = -(p12*p9*y1*y2)/p10py1^2;

dfdpval(:,1,11) = (p12*y1*y3)/p11py1^2;
dfdpval(:,3,11) = -(p12*p9*y1*y3)/p11py1^2;

dfdpval(:,1,12) = -(y1*y2)/p10py1 - (y1*y3)/p11py1;
dfdpval(:,2,12) = (p9*y1*y2)/p10py1;
dfdpval(:,3,12) = (p9*y1*y3)/p11py1;

dfdpval(:,2,13) = -(p3*y2*(y4 + y5)*E15p1)/(p15 + p3*y2 + p4*y3 + p15*E15 + p16*E15);
dfdpval(:,3,13) = -(p4*y3*(y4 + y5)*E15p1)/(p15 + p3*y2 + p4*y3 + p15*E15 + p16*E15);
dfdpval(:,4,13) =  (p14*y4*E15p1*(p3*y2 + p4*y3))/(p15 + p3*y2 + p4*y3 + p15*E15 + p16*E15);

dfdpval(:,4,14) = (p13*y4*E15p1*(p3*y2 + p4*y3))/(p15 + p3*y2 + p4*y3 + p15*E15 + p16*E15);

dfdpval(:,3,15) =  (p13*p4*y3*(y4 + y5)*E10p1^2)/(p15 + p16 + p15*E10 + p3*y2*E10 + p4*y3*E10)^2;
dfdpval(:,2,15) =  (p13*p3*y2*(y4 + y5)*E10p1^2)/(p15 + p16 + p15*E10 + p3*y2*E10 + p4*y3*E10)^2;
dfdpval(:,4,15) = -(p13*p14*y4*(p3*y2 + p4*y3))/(p15 + p16/E10p1 + (E10*(p3*y2 + p4*y3))/E10p1)^2;

dfdpval(:,2,16) =  (p13*p3*y2*(y4 + y5)*(1/E10p1 - (100*E10*(p3*y2 + p4*y3))/E10p1 + (100*E11*(p3*y2 + p4*y3))/E10p1^2) + (100*p13*p16*p3*y2*E10*(y4 + y5))/E10p1^2)/(p15 + p16/E10p1 + (E10*(p3*y2 + p4*y3))/E10p1)^2;
dfdpval(:,3,16) =  (p13*p4*y3*(y4 + y5)*(1/E10p1 - (100*E10*(p3*y2 + p4*y3))/E10p1 + (100*E11*(p3*y2 + p4*y3))/E10p1^2) + (100*p13*p16*p4*y3*E10*(y4 + y5))/E10p1^2)/(p15 + p16/E10p1 + (E10*(p3*y2 + p4*y3))/E10p1)^2;
dfdpval(:,4,16) = -(p13*p14*y4*(p3*y2 + p4*y3)*(E10 + 100*p16*E10 - 100*p3*y2*E10 - 100*p4*y3*E10 + 1))/(p15 + p16 + p15*E10 + p3*y2*E10 + p4*y3*E10)^2;

end

