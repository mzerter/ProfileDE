%  Useful intermediate variables

p3  = p(3);
p4  = p(4);
p5  = p(5);
p6  = p(6);
p7  = p(7);
p8  = p(8);
p9  = p(9);
p10 = p(10);
p11 = p(11);
p12 = p(12);
p13 = p(13);
p14 = p(14);
p15 = p(15);
p16 = p(16);

y1 = y(:,1);
y2 = y(:,2);
y3 = y(:,3);
y4 = y(:,4);
y5 = y(:,5);

p10py1 = p10 + y1;
p11py1 = p11 + y1;

% E1 = exp( 100*p3*y2 + 100*p4*y3 - 100*p16);
% E2 = exp( 200*p16 - 200*p3*y2 - 200*p4*y3);
% E3 = exp(-200*p16 + 200*p3*y2 + 200*p4*y3);
% E4 = exp(-300*p16 + 300*p3*y2 + 300*p4*y3);
% E5 = exp( 400*p16 - 400*p3*y2 - 400*p4*y3);
% E6 = exp( 300*p16 - 300*p3*y2 - 300*p4*y3);
% E7 = exp( 100*p3*y2);
% E8 = exp( 100*p4*y3);
% E9 = exp( 100*p16);
E10 = exp( 100*p3*y2 - 100*p16 + 100*p4*y3);
E11 = exp( 200*p3*y2 - 200*p16 + 200*p4*y3);
E12 = exp( 300*p3*y2 - 300*p16 + 300*p4*y3);
E13 = exp( 400*p3*y2 - 400*p16 + 400*p4*y3);
E14 = exp(  50*p3*y2 - 50*p16 + 50*p4*y3);
E15 = exp( 100*p16 - 100*p3*y2 - 100*p4*y3);

E10p1 = E10 + 1;
E15p1 = E15 + 1;

R1 = 100*p3*y2 - 100*p16 + 100*p4*y3 + 1;

%  powers up to 3 of first three as well

%  ------------------------------------------------------------------------
%                   derivatives of f's wrt y's
%  ------------------------------------------------------------------------

% y1

dfdxval(:,1,1) = (p12*y1*y2)/(p10 + y1)^2 - (p12*y2)/(p10 + y1) - (p12*y3)/(p11 + y1) - p6 + (p12*y1*y3)/(p11 + y1)^2;
dfdxval(:,1,2) = (p9*p10*p12*y2)/(p10 + y1)^2;
dfdxval(:,1,3) = (p9*p11*p12*y3)/(p11 + y1)^2;
0
0

% y2

dfdxval(:,2,1) = -(p12*y1)/(p10 + y1);
dfdxval(:,2,2) = (p9*p12*y1)/(p10 + y1) - p6 - (p3*p13*(y4 + y5))/(p15 + (p3*y2 + p4*y3)/(1/exp(p1*(p3*y2 - p16 + p4*y3)) + 1)) + (p3*p13*y2*(y4 + y5)*(p3/(1/exp(p1*(p3*y2 - p16 + p4*y3)) + 1) + (p1*p3*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1)^2)))/(p15 + (p3*y2 + p4*y3)/(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1))^2;
dfdxval(:,2,3) = (p4*p13*y3*(y4 + y5)*(p3/(1/exp(p1*(p3*y2 - p16 + p4*y3)) + 1) + (p1*p3*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1)^2)))/(p15 + (p3*y2 + p4*y3)/(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1))^2;
dfdxval(:,2,4) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(p3*p13*p14*y4*(p1*p3^2*y2^2 + 2*p1*p3*p4*y2*y3 + p1*p4^2*y3^2) - 2*p3*p13*p14*p15*y4) - p3*p13*p14*p15*y4*(exp(2*p1*(p3*y2 - p16 + p4*y3)) + 1))/(p15 + p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
0

% y3

dfdxval(:,3,1) = -(p12*y1)/(p11 + y1);
dfdxval(:,3,2) = (p3*p13*y2*(y4 + y5)*(p4/(1/exp(p1*(p3*y2 - p16 + p4*y3)) + 1) + (p1*p4*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1)^2)))/(p15 + (p3*y2 + p4*y3)/(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1))^2;
dfdxval(:,3,3) = (p9*p12*y1)/(p11 + y1) - p6 - (p4*p13*(y4 + y5))/(p15 + (p3*y2 + p4*y3)/(1/exp(p1*(p3*y2 - p16 + p4*y3)) + 1)) + (p4*p13*y3*(y4 + y5)*(p4/(1/exp(p1*(p3*y2 - p16 + p4*y3)) + 1) + (p1*p4*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1)^2)))/(p15 + (p3*y2 + p4*y3)/(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1))^2;
dfdxval(:,3,4) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(p4*p13*p14*y4*(p1*p3^2*y2^2 + 2*p1*p3*p4*y2*y3 + p1*p4^2*y3^2) - 2*p4*p13*p14*p15*y4) - p4*p13*p14*p15*y4*(exp(2*p1*(p3*y2 - p16 + p4*y3)) + 1))/(p15 + p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
0

% y4

0
dfdxval(:,4,2) = -(p3*p13*y2)/(p15 + (p3*y2 + p4*y3)/(1/exp(p1*(p3*y2 - p16 + p4*y3)) + 1));
dfdxval(:,4,3) = -(p4*p13*y3)/(p15 + (p3*y2 + p4*y3)/(1/exp(p1*(p3*y2 - p16 + p4*y3)) + 1)); 
dfdxval(:,4,4) = (p13*p14*(p3*y2 + p4*y3))/(p15 + (p3*y2 + p4*y3)/(1/exp(p1*(p3*y2 - p16 + p4*y3)) + 1)) - p7 - p8 - p6;
dfdxval(:,4,5) = p8;

% y5

0 
dfdxval(:,5,2) = -(p3*p13*y2)/(p15 + (p3*y2 + p4*y3)/(1/exp(p1*(p3*y2 - p16 + p4*y3)) + 1)); 
dfdxval(:,5,3) = -(p4*p13*y3)/(p15 + (p3*y2 + p4*y3)/(1/exp(p1*(p3*y2 - p16 + p4*y3)) + 1)); 
0
dfdxval(:,5,5) = - p6 - p7;

%  ------------------------------------------------------------------------
%     second derivatives of five functions wrt five y's 
%  ------------------------------------------------------------------------

% y1-y1
d2fdx2val(:,1,1,1) = (2*p12*y2)/(p10 + y1)^2 + (2*p12*y3)/(p11 + y1)^2 - (2*p12*y1*y2)/(p10 + y1)^3 - (2*p12*y1*y3)/(p11 + y1)^3;
d2fdx2val(:,2,1,1) = -(2*p9*p10*p12*y2)/(p10 + y1)^3;
d2fdx2val(:,3,1,1) = -(2*p9*p11*p12*y3)/(p11 + y1)^3;
0
0

% y2-y1
d2fdx2val(:,1,2,1) = -(p10*p12)/(p10 + y1)^2;
d2fdx2val(:,2,2,1) = (p9*p10*p12)/(p10 + y1)^2;
0
0
0

% y3-y1
d2fdx2val(:,1,3,1) = -(p11*p12)/(p11 + y1)^2; 
0
d2fdx2val(:,3,3,1) = (p9*p11*p12)/(p11 + y1)^2;
0
0

% y4-y1
0
0
0
0
0

% y5-y1
0
0
0
0
0

% y1-y2
d2fdx2val(:,1,1,2) = -(p10*p12)/(p10 + y1)^2;
d2fdx2val(:,2,1,2) =  (p9*p10*p12)/(p10 + y1)^2;
0
0
0

% y2-y2
0
d2fdx2val(:,2,2,2) =  (exp(p1*(p3*y2 - p16 + p4*y3))*(p3^2*p13*p15*(y4 + y5)*(2*p2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 4*p1*p3*y2 + 2*p1*p4*y3 + p1^2*p3^2*y2^2 + p1^2*p3*p4*y2*y3 + 2) + 2*p2*p3^2*p4*p13*y3*exp(2*p1*(p3*y2 - p16 + p4*y3))*(y4 + y5)) + exp(2*p1*(p3*y2 - p16 + p4*y3))*(p3^2*p13*(y4 + y5)*(- p1^2*p3^3*y2^3 - 2*p1^2*p3^2*p4*y2^2*y3 - p1^2*p3*p4^2*y2*y3^2 + 2*p1*p3*p4*y2*y3 + 2*p1*p4^2*y3^2 + 2*p4*y3) + p3^2*p13*p15*(y4 + y5)*(- p2*p1^2*p3^2*y2^2 - p2*p4*y3*p1^2*p3*y2 + 4*p2*p1*p3*y2 + 2*p2*p4*y3*p1 + 4*p2)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3; 
d2fdx2val(:,3,2,2) = -(exp(2*p1*(p3*y2 - p16 + p4*y3))*(p3^2*p4*p13*y3*(y4 + y5)*(p1^2*p3^2*y2^2 + 2*p1^2*p3*p4*y2*y3 + p1^2*p4^2*y3^2 + 2*p1*p3*y2 + 2*p1*p4*y3 + 2) + p3^2*p4*p13*p15*y3*(y4 + y5)*(p1^2*p2*p3*y2 - 2*p1*p2 + p1^2*p2*p4*y3)) + exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2*p3^2*p4*p13*y3*exp(2*p1*(p3*y2 - p16 + p4*y3))*(y4 + y5) - p3^2*p4*p13*p15*y3*(y4 + y5)*(2*p1 + p1^2*p3*y2 + p1^2*p4*y3)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
d2fdx2val(:,4,2,2) =  (exp(2*p1*(p3*y2 - p16 + p4*y3))*(p3^2*p13*p14*y4*(p1^2*p3^3*y2^3 + 3*p1^2*p3^2*p4*y2^2*y3 + 3*p1^2*p3*p4^2*y2*y3^2 + p1^2*p4^3*y3^3) - p3^2*p13*p14*p15*y4*(- p2*p1^2*p3^2*y2^2 - 2*p2*p1^2*p3*p4*y2*y3 - p2*p1^2*p4^2*y3^2 + 4*p2*p1*p3*y2 + 4*p2*p1*p4*y3 + 4*p2)) - p3^2*p13*p14*p15*y4*exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 4*p1*p3*y2 + 4*p1*p4*y3 + p1^2*p3^2*y2^2 + p1^2*p4^2*y3^2 + 2*p1^2*p3*p4*y2*y3 + 2))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
0

% y3-y2
0
d2fdx2val(:,2,3,2) = -(exp(2*p1*(p3*y2 - p16 + p4*y3))*(p3*p4*p13*(y4 + y5)*(p1^2*p3^3*y2^3 + 2*p1^2*p3^2*p4*y2^2*y3 + p1^2*p3*p4^2*y2*y3^2 + p1*p3^2*y2^2 - p1*p4^2*y3^2 + p3*y2 - p4*y3) - p3*p4*p13*p15*(y4 + y5)*(- p2*p1^2*p3^2*y2^2 - p2*p4*y3*p1^2*p3*y2 + 3*p2*p1*p3*y2 + p2*p4*y3*p1 + 2*p2)) + exp(p1*(p3*y2 - p16 + p4*y3))*(p3*p4*p13*(y4 + y5)*(p2*p3*y2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2*p4*y3*exp(2*p1*(p3*y2 - p16 + p4*y3))) - p3*p4*p13*p15*(y4 + y5)*(p2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 3*p1*p3*y2 + p1*p4*y3 + p1^2*p3^2*y2^2 + p1^2*p3*p4*y2*y3 + 1)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3; 
d2fdx2val(:,3,3,2) = -(exp(2*p1*(p3*y2 - p16 + p4*y3))*(p3*p4*p13*(y4 + y5)*(p1^2*p3^2*p4*y2^2*y3 + 2*p1^2*p3*p4^2*y2*y3^2 + p1^2*p4^3*y3^3 - p1*p3^2*y2^2 + p1*p4^2*y3^2 - p3*y2 + p4*y3) - p3*p4*p13*p15*(y4 + y5)*(- p2*p1^2*p4^2*y3^2 - p2*p3*y2*p1^2*p4*y3 + 3*p2*p1*p4*y3 + p2*p3*y2*p1 + 2*p2)) - exp(p1*(p3*y2 - p16 + p4*y3))*(p3*p4*p13*(y4 + y5)*(p2*p3*y2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2*p4*y3*exp(2*p1*(p3*y2 - p16 + p4*y3))) + p3*p4*p13*p15*(y4 + y5)*(p2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p1*p3*y2 + 3*p1*p4*y3 + p1^2*p4^2*y3^2 + p1^2*p3*p4*y2*y3 + 1)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3; 
d2fdx2val(:,4,3,2) =  (exp(2*p1*(p3*y2 - p16 + p4*y3))*(p3*p4*p13*p14*y4*(p1^2*p3^3*y2^3 + 3*p1^2*p3^2*p4*y2^2*y3 + 3*p1^2*p3*p4^2*y2*y3^2 + p1^2*p4^3*y3^3) - p3*p4*p13*p14*p15*y4*(- p2*p1^2*p3^2*y2^2 - 2*p2*p1^2*p3*p4*y2*y3 - p2*p1^2*p4^2*y3^2 + 4*p2*p1*p3*y2 + 4*p2*p1*p4*y3 + 4*p2)) - p3*p4*p13*p14*p15*y4*exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 4*p1*p3*y2 + 4*p1*p4*y3 + p1^2*p3^2*y2^2 + p1^2*p4^2*y3^2 + 2*p1^2*p3*p4*y2*y3 + 2))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
0

% y4-y2
0
d2fdx2val(:,2,4,2) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2*p3*p13*p15 + p3*p4*p13*(y3 - p1*p3*y2*y3) - p1*p3^3*p13*y2^2) + p3*p13*p15*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1) + p2*p3*p4*p13*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2; 
d2fdx2val(:,3,4,2) =  (p4*p13*y3*(p3/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))) + (p1*p3*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(p2 + exp(-p1*(p3*y2 - p16 + p4*y3)))^2)))/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^2;
d2fdx2val(:,4,4,2) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(p3*p13*p14*(p1*p3^2*y2^2 + 2*p1*p3*p4*y2*y3 + p1*p4^2*y3^2) - 2*p2*p3*p13*p14*p15) - p3*p13*p14*p15*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
0

% y5-y2
0
d2fdx2val(:,2,5,2) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2*p3*p13*p15 + p3*p4*p13*(y3 - p1*p3*y2*y3) - p1*p3^3*p13*y2^2) + p3*p13*p15*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1) + p2*p3*p4*p13*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2; 
d2fdx2val(:,3,5,2) =  (p4*p13*y3*(p3/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))) + (p1*p3*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(p2 + exp(-p1*(p3*y2 - p16 + p4*y3)))^2)))/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^2;
0
0

% y1-y3
d2fdx2val(:,1,1,3) = -(p11*p12)/(p11 + y1)^2;
0
d2fdx2val(:,3,1,3) = (p9*p11*p12)/(p11 + y1)^2;
0
0

%
% y2-y3
0
d2fdx2val(:,2,2,3) = -(exp(2*p1*(p3*y2 - p16 + p4*y3))*(p3*p4*p13*(y4 + y5)*(p1^2*p3^3*y2^3 + 2*p1^2*p3^2*p4*y2^2*y3 + p1^2*p3*p4^2*y2*y3^2 + p1*p3^2*y2^2 - p1*p4^2*y3^2 + p3*y2 - p4*y3) - p3*p4*p13*p15*(y4 + y5)*(- p2*p1^2*p3^2*y2^2 - p2*p4*y3*p1^2*p3*y2 + 3*p2*p1*p3*y2 + p2*p4*y3*p1 + 2*p2)) + exp(p1*(p3*y2 - p16 + p4*y3))*(p3*p4*p13*(y4 + y5)*(p2*p3*y2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2*p4*y3*exp(2*p1*(p3*y2 - p16 + p4*y3))) - p3*p4*p13*p15*(y4 + y5)*(p2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 3*p1*p3*y2 + p1*p4*y3 + p1^2*p3^2*y2^2 + p1^2*p3*p4*y2*y3 + 1)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
d2fdx2val(:,3,2,3) = -(exp(2*p1*(p3*y2 - p16 + p4*y3))*(p3*p4*p13*(y4 + y5)*(p1^2*p3^2*p4*y2^2*y3 + 2*p1^2*p3*p4^2*y2*y3^2 + p1^2*p4^3*y3^3 - p1*p3^2*y2^2 + p1*p4^2*y3^2 - p3*y2 + p4*y3) - p3*p4*p13*p15*(y4 + y5)*(- p2*p1^2*p4^2*y3^2 - p2*p3*y2*p1^2*p4*y3 + 3*p2*p1*p4*y3 + p2*p3*y2*p1 + 2*p2)) - exp(p1*(p3*y2 - p16 + p4*y3))*(p3*p4*p13*(y4 + y5)*(p2*p3*y2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2*p4*y3*exp(2*p1*(p3*y2 - p16 + p4*y3))) + p3*p4*p13*p15*(y4 + y5)*(p2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p1*p3*y2 + 3*p1*p4*y3 + p1^2*p4^2*y3^2 + p1^2*p3*p4*y2*y3 + 1)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
d2fdx2val(:,4,2,3) =  (exp(2*p1*(p3*y2 - p16 + p4*y3))*(p3*p4*p13*p14*y4*(p1^2*p3^3*y2^3 + 3*p1^2*p3^2*p4*y2^2*y3 + 3*p1^2*p3*p4^2*y2*y3^2 + p1^2*p4^3*y3^3) - p3*p4*p13*p14*p15*y4*(- p2*p1^2*p3^2*y2^2 - 2*p2*p1^2*p3*p4*y2*y3 - p2*p1^2*p4^2*y3^2 + 4*p2*p1*p3*y2 + 4*p2*p1*p4*y3 + 4*p2)) - p3*p4*p13*p14*p15*y4*exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 4*p1*p3*y2 + 4*p1*p4*y3 + p1^2*p3^2*y2^2 + p1^2*p4^2*y3^2 + 2*p1^2*p3*p4*y2*y3 + 2))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
0

% y3-y3
0
d2fdx2val(:,2,3,3) = -(exp(2*p1*(p3*y2 - p16 + p4*y3))*(p3*p4^2*p13*y2*(y4 + y5)*(p1^2*p3^2*y2^2 + 2*p1^2*p3*p4*y2*y3 + p1^2*p4^2*y3^2 + 2*p1*p3*y2 + 2*p1*p4*y3 + 2) + p3*p4^2*p13*p15*y2*(y4 + y5)*(p1^2*p2*p3*y2 - 2*p1*p2 + p1^2*p2*p4*y3)) + exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2*p3*p4^2*p13*y2*exp(2*p1*(p3*y2 - p16 + p4*y3))*(y4 + y5) - p3*p4^2*p13*p15*y2*(y4 + y5)*(2*p1 + p1^2*p3*y2 + p1^2*p4*y3)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3; 
d2fdx2val(:,3,3,3) =  (exp(p1*(p3*y2 - p16 + p4*y3))*(p4^2*p13*p15*(y4 + y5)*(2*p2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 2*p1*p3*y2 + 4*p1*p4*y3 + p1^2*p4^2*y3^2 + p1^2*p3*p4*y2*y3 + 2) + 2*p2*p3*p4^2*p13*y2*exp(2*p1*(p3*y2 - p16 + p4*y3))*(y4 + y5)) + exp(2*p1*(p3*y2 - p16 + p4*y3))*(p4^2*p13*(y4 + y5)*(- p1^2*p3^2*p4*y2^2*y3 - 2*p1^2*p3*p4^2*y2*y3^2 - p1^2*p4^3*y3^3 + 2*p1*p3^2*y2^2 + 2*p1*p3*p4*y2*y3 + 2*p3*y2) + p4^2*p13*p15*(y4 + y5)*(- p2*p1^2*p4^2*y3^2 - p2*p3*y2*p1^2*p4*y3 + 4*p2*p1*p4*y3 + 2*p2*p3*y2*p1 + 4*p2)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
d2fdx2val(:,4,3,3) =  (exp(2*p1*(p3*y2 - p16 + p4*y3))*(p4^2*p13*p14*y4*(p1^2*p3^3*y2^3 + 3*p1^2*p3^2*p4*y2^2*y3 + 3*p1^2*p3*p4^2*y2*y3^2 + p1^2*p4^3*y3^3) - p4^2*p13*p14*p15*y4*(- p2*p1^2*p3^2*y2^2 - 2*p2*p1^2*p3*p4*y2*y3 - p2*p1^2*p4^2*y3^2 + 4*p2*p1*p3*y2 + 4*p2*p1*p4*y3 + 4*p2)) - p4^2*p13*p14*p15*y4*exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 4*p1*p3*y2 + 4*p1*p4*y3 + p1^2*p3^2*y2^2 + p1^2*p4^2*y3^2 + 2*p1^2*p3*p4*y2*y3 + 2))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
0 

% y4-y3
0
d2fdx2val(:,2,4,3) =  (p3*p13*y2*(p4/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))) + (p1*p4*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(p2 + exp(-p1*(p3*y2 - p16 + p4*y3)))^2)))/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^2; 
d2fdx2val(:,3,4,3) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2*p4*p13*p15 + p3*p4*p13*(y2 - p1*p4*y2*y3) - p1*p4^3*p13*y3^2) + p4*p13*p15*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1) + p2*p3*p4*p13*y2*exp(2*p1*(p3*y2 - p16 + p4*y3)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2; 
d2fdx2val(:,4,4,3) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(p4*p13*p14*(p1*p3^2*y2^2 + 2*p1*p3*p4*y2*y3 + p1*p4^2*y3^2) - 2*p2*p4*p13*p14*p15) - p4*p13*p14*p15*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
0

% y5-y3
0
d2fdx2val(:,2,5,3) =  (p3*p13*y2*(p4/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))) + (p1*p4*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(p2 + exp(-p1*(p3*y2 - p16 + p4*y3)))^2)))/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^2; 
d2fdx2val(:,3,5,3) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2*p4*p13*p15 + p3*p4*p13*(y2 - p1*p4*y2*y3) - p1*p4^3*p13*y3^2) + p4*p13*p15*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1) + p2*p3*p4*p13*y2*exp(2*p1*(p3*y2 - p16 + p4*y3)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
0
0

% y1-y4
0
0
0
0
0

% y2-y4
0
d2fdx2val(:,2,2,4) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2*p3*p13*p15 + p3*p4*p13*(y3 - p1*p3*y2*y3) - p1*p3^3*p13*y2^2) + p3*p13*p15*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1) + p2*p3*p4*p13*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
d2fdx2val(:,3,2,4) =  (p4*p13*y3*(p3/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))) + (p1*p3*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(p2 + exp(-p1*(p3*y2 - p16 + p4*y3)))^2)))/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^2;
d2fdx2val(:,4,2,4) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(p3*p13*p14*(p1*p3^2*y2^2 + 2*p1*p3*p4*y2*y3 + p1*p4^2*y3^2) - 2*p2*p3*p13*p14*p15) - p3*p13*p14*p15*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
0

% y3-y4
0
d2fdx2val(:,2,3,4) =  (p3*p13*y2*(p4/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))) + (p1*p4*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(p2 + exp(-p1*(p3*y2 - p16 + p4*y3)))^2)))/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^2;
d2fdx2val(:,3,3,4) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2*p4*p13*p15 + p3*p4*p13*(y2 - p1*p4*y2*y3) - p1*p4^3*p13*y3^2) + p4*p13*p15*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1) + p2*p3*p4*p13*y2*exp(2*p1*(p3*y2 - p16 + p4*y3)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
d2fdx2val(:,4,3,4) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(p4*p13*p14*(p1*p3^2*y2^2 + 2*p1*p3*p4*y2*y3 + p1*p4^2*y3^2) - 2*p2*p4*p13*p14*p15) - p4*p13*p14*p15*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
0

% y4-y4
0
0
0
0
0

% y5-y4
0
0
0
0
0

% y1-y5
0
0
0
0
0

% y2-y5
0
d2fdx2val(:,2,2,5) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2*p3*p13*p15 + p3*p4*p13*(y3 - p1*p3*y2*y3) - p1*p3^3*p13*y2^2) + p3*p13*p15*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1) + p2*p3*p4*p13*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2; 
d2fdx2val(:,3,2,5) =  (p4*p13*y3*(p3/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))) + (p1*p3*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(p2 + exp(-p1*(p3*y2 - p16 + p4*y3)))^2)))/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^2;
0
0

% y3-y5
0
d2fdx2val(:,2,3,5) =  (p3*p13*y2*(p4/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))) + (p1*p4*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(p2 + exp(-p1*(p3*y2 - p16 + p4*y3)))^2)))/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^2; 
d2fdx2val(:,3,3,5) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2*p4*p13*p15 + p3*p4*p13*(y2 - p1*p4*y2*y3) - p1*p4^3*p13*y3^2) + p4*p13*p15*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1) + p2*p3*p4*p13*y2*exp(2*p1*(p3*y2 - p16 + p4*y3)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
0
0

% y4-y5
0
0
0
0
0

% y5-y5
0
0
0
0
0

%  ------------------------------------------------------------------------
%                   derivatives of f's wrt the last 14p's
%  ------------------------------------------------------------------------

% p3

0 
dfdpval(:,2,3) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(2*p13*p15*y2*(y4 + y5) - p13*y2*(y4 + y5)*(p1*p3^2*y2^2 + p1*p4*y3*p3*y2 - p4*y3)) + p13*p15*y2*(y4 + y5)*(exp(2*p1*(p3*y2 - p16 + p4*y3)) + 1) + p4*p13*y2*y3*exp(2*p1*(p3*y2 - p16 + p4*y3))*(y4 + y5))/(p15 + p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2; 
dfdpval(:,3,3) = (p4*p13*y3*(y4 + y5)*(y2/(1/exp(p1*(p3*y2 - p16 + p4*y3)) + 1) + (p1*y2*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1)^2)))/(p15 + (p3*y2 + p4*y3)/(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1))^2;
dfdpval(:,4,3) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(p13*p14*y2*y4*(p1*p3^2*y2^2 + 2*p1*p3*p4*y2*y3 + p1*p4^2*y3^2) - 2*p13*p14*p15*y2*y4) - p13*p14*p15*y2*y4*(exp(2*p1*(p3*y2 - p16 + p4*y3)) + 1))/(p15 + p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
0

% p4

0 
dfdpval(:,2,4) = (p3*p13*y2*(y4 + y5)*(y3/(1/exp(p1*(p3*y2 - p16 + p4*y3)) + 1) + (p1*y3*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1)^2)))/(p15 + (p3*y2 + p4*y3)/(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1))^2; 
dfdpval(:,3,4) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(2*p13*p15*y3*(y4 + y5) - p13*y3*(y4 + y5)*(p1*p4^2*y3^2 + p1*p3*y2*p4*y3 - p3*y2)) + p13*p15*y3*(y4 + y5)*(exp(2*p1*(p3*y2 - p16 + p4*y3)) + 1) + p3*p13*y2*y3*exp(2*p1*(p3*y2 - p16 + p4*y3))*(y4 + y5))/(p15 + p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
dfdpval(:,4,4) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(p13*p14*y3*y4*(p1*p3^2*y2^2 + 2*p1*p3*p4*y2*y3 + p1*p4^2*y3^2) - 2*p13*p14*p15*y3*y4) - p13*p14*p15*y3*y4*(exp(2*p1*(p3*y2 - p16 + p4*y3)) + 1))/(p15 + p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
0

% p5

dfdpval(:,1,5) = p6;
0
0
0
0

% p6

dfdpval(:,1,6) = p5 - y1;
dfdpval(:,2,6) = -y2;
dfdpval(:,3,6) = -y3;
dfdpval(:,4,6) = -y4;
dfdpval(:,5,6) = -y5;

% p7

0
0
0
dfdpval(:,4,7) = -y4;
dfdpval(:,5,7) = -y5;

% p8

0
0
0
dfdpval(:,4,8) = -y4;
dfdpval(:,5,8) = y4;

% p9

0
dfdpval(:,2,9) = (p12*y1*y2)/(p10 + y1);
dfdpval(:,3,9) = (p12*y1*y3)/(p11 + y1);
0
0

% p10

dfdpval(:,1,10) = (p12*y1*y2)/(p10 + y1)^2;
dfdpval(:,2,10) = -(p9*p12*y1*y2)/(p10 + y1)^2;
0
0
0

% p11

dfdpval(:,1,11) = (p12*y1*y3)/(p11 + y1)^2;
0
dfdpval(:,3,11) = -(p9*p12*y1*y3)/(p11 + y1)^2;
0
0

% p12

dfdpval(:,1,12) = - (y1*y2)/(p10 + y1) - (y1*y3)/(p11 + y1);
dfdpval(:,2,12) = (p9*y1*y2)/(p10 + y1);
dfdpval(:,3,12) = (p9*y1*y3)/(p11 + y1);
0
0

% p13
0
dfdpval(:,2,13) = -(p3*y2*(y4 + y5))/(p15 + (p3*y2 + p4*y3)/(1/exp(p1*(p3*y2 - p16 + p4*y3)) + 1)); 
dfdpval(:,3,13) = -(p4*y3*(y4 + y5))/(p15 + (p3*y2 + p4*y3)/(1/exp(p1*(p3*y2 - p16 + p4*y3)) + 1));
dfdpval(:,4,13) = (p14*y4*(p3*y2 + p4*y3))/(p15 + (p3*y2 + p4*y3)/(1/exp(p1*(p3*y2 - p16 + p4*y3)) + 1));
0

% p14

0
0
0
dfdpval(:,4,14) = (p13*y4*(p3*y2 + p4*y3))/(p15 + (p3*y2 + p4*y3)/(1/exp(p1*(p3*y2 - p16 + p4*y3)) + 1));
0

% p15

0
dfdpval(:,2,15) = (p3*p13*y2*(y4 + y5))/(p15 + (p3*y2 + p4*y3)/(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1))^2; 
dfdpval(:,3,15) = (p4*p13*y3*(y4 + y5))/(p15 + (p3*y2 + p4*y3)/(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1))^2;
dfdpval(:,4,15) = -(p13*p14*y4*(p3*y2 + p4*y3))/(p15 + (p3*y2 + p4*y3)/(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1))^2;
0

% p16

0
dfdpval(:,2,16) = -(p1*p3*p13*y2*(y4 + y5)*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1)^2*(p15 + (p3*y2 + p4*y3)/(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1))^2); 
dfdpval(:,3,16) = -(p1*p4*p13*y3*(y4 + y5)*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1)^2*(p15 + (p3*y2 + p4*y3)/(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1))^2); 
dfdpval(:,4,16) = (p1*p13*p14*y4*(p3*y2 + p4*y3)^2)/(exp(p1*(p3*y2 - p16 + p4*y3))*(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1)^2*(p15 + (p3*y2 + p4*y3)/(exp(-p1*(p3*y2 - p16 + p4*y3)) + 1))^2);
0

%  ------------------------------------------------------------------------
%     second derivatives of f's wrt y's and wrt last 14 p's
%  ------------------------------------------------------------------------

% y1-p3
0
0
0
0
0

% y2-p3
0
d2fdxdpval(:,2,2,3) = -(p13*(y4 + y5)*(p15^2 + 3*p2^2*p15^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p2^3*p15^2*exp(3*p1*(p3*y2 - p16 + p4*y3)) + p4^2*y3^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p1*p3^3*y2^3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p2*p4^2*y3^2*exp(3*p1*(p3*y2 - p16 + p4*y3)) + p1^2*p3^4*y2^4*exp(2*p1*(p3*y2 - p16 + p4*y3)) - 2*p2*p3*p15*y2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 4*p2*p4*p15*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p3*p4*y2*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2^2*p3*p15*y2*exp(3*p1*(p3*y2 - p16 + p4*y3)) + 2*p2^2*p4*p15*y3*exp(3*p1*(p3*y2 - p16 + p4*y3)) - 5*p1*p2*p3^2*p15*y2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - 3*p1*p3*p4^2*y2*y3^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - 4*p1*p3^2*p4*y2^2*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p1^2*p3^2*p4^2*y2^2*y3^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2*p3*p4*y2*y3*exp(3*p1*(p3*y2 - p16 + p4*y3)) + p1^2*p2*p3^3*p15*y2^3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 2*p1^2*p3^3*p4*y2^3*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)) - 3*p1*p2*p3*p4*p15*y2*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p1^2*p2*p3^2*p4*p15*y2^2*y3*exp(2*p1*(p3*y2 - p16 + p4*y3))) - p13*exp(p1*(p3*y2 - p16 + p4*y3))*(y4 + y5)*(p1^2*p3^3*p15*y2^3 + p4*y3*p1^2*p3^2*p15*y2^2 + 5*p1*p3^2*p15*y2^2 + 3*p4*y3*p1*p3*p15*y2 + p3*p15*y2 - 3*p2*p15^2 - 2*p4*y3*p15))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
d2fdxdpval(:,3,2,3) = -(exp(2*p1*(p3*y2 - p16 + p4*y3))*(p4*p13*y3*(y4 + y5)*(p1^2*p3^3*y2^3 + 2*p1^2*p3^2*p4*y2^2*y3 + p1^2*p3*p4^2*y2*y3^2 + p1*p3^2*y2^2 - p1*p4^2*y3^2 + p3*y2 - p4*y3) - p4*p13*p15*y3*(y4 + y5)*(- p2*p1^2*p3^2*y2^2 - p2*p4*y3*p1^2*p3*y2 + 3*p2*p1*p3*y2 + p2*p4*y3*p1 + 2*p2)) + exp(p1*(p3*y2 - p16 + p4*y3))*(p4*p13*y3*(y4 + y5)*(p2*p3*y2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2*p4*y3*exp(2*p1*(p3*y2 - p16 + p4*y3))) - p4*p13*p15*y3*(y4 + y5)*(p2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 3*p1*p3*y2 + p1*p4*y3 + p1^2*p3^2*y2^2 + p1^2*p3*p4*y2*y3 + 1)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
d2fdxdpval(:,4,2,3) =  (p13*p14*y4*(p15^2 + 3*p2^2*p15^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p2^3*p15^2*exp(3*p1*(p3*y2 - p16 + p4*y3)) - p1*p3^3*y2^3*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p1*p4^3*y3^3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p1^2*p3^4*y2^4*exp(2*p1*(p3*y2 - p16 + p4*y3)) - 2*p2*p3*p15*y2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 2*p2*p4*p15*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2^2*p3*p15*y2*exp(3*p1*(p3*y2 - p16 + p4*y3)) + p2^2*p4*p15*y3*exp(3*p1*(p3*y2 - p16 + p4*y3)) - 5*p1*p2*p3^2*p15*y2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p1*p2*p4^2*p15*y3^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - 3*p1*p3*p4^2*y2*y3^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - 3*p1*p3^2*p4*y2^2*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 3*p1^2*p3^2*p4^2*y2^2*y3^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p1^2*p2*p3^3*p15*y2^3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p1^2*p3*p4^3*y2*y3^3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 3*p1^2*p3^3*p4*y2^3*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)) - 6*p1*p2*p3*p4*p15*y2*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p1^2*p2*p3*p4^2*p15*y2*y3^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 2*p1^2*p2*p3^2*p4*p15*y2^2*y3*exp(2*p1*(p3*y2 - p16 + p4*y3))) - p13*p14*y4*exp(p1*(p3*y2 - p16 + p4*y3))*(p1^2*p3^3*p15*y2^3 + 2*p1^2*p3^2*p4*p15*y2^2*y3 + p1^2*p3*p4^2*p15*y2*y3^2 + 5*p1*p3^2*p15*y2^2 + 6*p1*p3*p4*p15*y2*y3 + p1*p4^2*p15*y3^2 + p3*p15*y2 - p4*p15*y3 - 3*p2*p15^2))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
0

% y3-p3
0
d2fdxdpval(:,2,3,3) = -(exp(2*p1*(p3*y2 - p16 + p4*y3))*(p4*p13*y2*(y4 + y5)*(p1^2*p3^3*y2^3 + 2*p1^2*p3^2*p4*y2^2*y3 + p1^2*p3*p4^2*y2*y3^2 + p1*p3^2*y2^2 - p1*p4^2*y3^2 + p3*y2 - p4*y3) - p4*p13*p15*y2*(y4 + y5)*(- p2*p1^2*p3^2*y2^2 - p2*p4*y3*p1^2*p3*y2 + 3*p2*p1*p3*y2 + p2*p4*y3*p1 + 2*p2)) + exp(p1*(p3*y2 - p16 + p4*y3))*(p4*p13*y2*(y4 + y5)*(p2*p3*y2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2*p4*y3*exp(2*p1*(p3*y2 - p16 + p4*y3))) - p4*p13*p15*y2*(y4 + y5)*(p2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 3*p1*p3*y2 + p1*p4*y3 + p1^2*p3^2*y2^2 + p1^2*p3*p4*y2*y3 + 1)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3; 
d2fdxdpval(:,3,3,3) = -(exp(2*p1*(p3*y2 - p16 + p4*y3))*(p4*p13*y2*(y4 + y5)*(p1^2*p3^2*p4*y2^2*y3 + 2*p1^2*p3*p4^2*y2*y3^2 + p1^2*p4^3*y3^3 - p1*p3^2*y2^2 + p1*p4^2*y3^2 - p3*y2 + p4*y3) - p4*p13*p15*y2*(y4 + y5)*(- p2*p1^2*p4^2*y3^2 - p2*p3*y2*p1^2*p4*y3 + 3*p2*p1*p4*y3 + p2*p3*y2*p1 + 2*p2)) - exp(p1*(p3*y2 - p16 + p4*y3))*(p4*p13*y2*(y4 + y5)*(p2*p3*y2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2*p4*y3*exp(2*p1*(p3*y2 - p16 + p4*y3))) + p4*p13*p15*y2*(y4 + y5)*(p2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p1*p3*y2 + 3*p1*p4*y3 + p1^2*p4^2*y3^2 + p1^2*p3*p4*y2*y3 + 1)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
d2fdxdpval(:,4,3,3) =  (exp(2*p1*(p3*y2 - p16 + p4*y3))*(p4*p13*p14*y2*y4*(p1^2*p3^3*y2^3 + 3*p1^2*p3^2*p4*y2^2*y3 + 3*p1^2*p3*p4^2*y2*y3^2 + p1^2*p4^3*y3^3) - p4*p13*p14*p15*y2*y4*(- p2*p1^2*p3^2*y2^2 - 2*p2*p1^2*p3*p4*y2*y3 - p2*p1^2*p4^2*y3^2 + 4*p2*p1*p3*y2 + 4*p2*p1*p4*y3 + 4*p2)) - p4*p13*p14*p15*y2*y4*exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 4*p1*p3*y2 + 4*p1*p4*y3 + p1^2*p3^2*y2^2 + p1^2*p4^2*y3^2 + 2*p1^2*p3*p4*y2*y3 + 2))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
0

% y4-p3
0
d2fdxdpval(:,2,4,3) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2*p13*p15*y2 + p4*p13*y2*(y3 - p1*p3*y2*y3) - p1*p3^2*p13*y2^3) + p13*p15*y2*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1) + p2*p4*p13*y2*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
d2fdxdpval(:,3,4,3) =  (p4*p13*y3*(y2/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))) + (p1*y2*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(p2 + exp(-p1*(p3*y2 - p16 + p4*y3)))^2)))/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^2; 
d2fdxdpval(:,4,4,3) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(p13*p14*y2*(p1*p3^2*y2^2 + 2*p1*p3*p4*y2*y3 + p1*p4^2*y3^2) - 2*p2*p13*p14*p15*y2) - p13*p14*p15*y2*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
0

% y5-p3
0
d2fdxdpval(:,2,5,3) = (exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2*p13*p15*y2 + p4*p13*y2*(y3 - p1*p3*y2*y3) - p1*p3^2*p13*y2^3) + p13*p15*y2*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1) + p2*p4*p13*y2*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
d2fdxdpval(:,3,5,3) = (p4*p13*y3*(y2/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))) + (p1*y2*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(p2 + exp(-p1*(p3*y2 - p16 + p4*y3)))^2)))/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^2;
0
0



% y1-p4
0
0
0
0
0

% y2-p4
0
d2fdxdpval(:,2,2,4) = -(exp(2*p1*(p3*y2 - p16 + p4*y3))*(p3*p13*y3*(y4 + y5)*(p1^2*p3^3*y2^3 + 2*p1^2*p3^2*p4*y2^2*y3 + p1^2*p3*p4^2*y2*y3^2 + p1*p3^2*y2^2 - p1*p4^2*y3^2 + p3*y2 - p4*y3) - p3*p13*p15*y3*(y4 + y5)*(- p2*p1^2*p3^2*y2^2 - p2*p4*y3*p1^2*p3*y2 + 3*p2*p1*p3*y2 + p2*p4*y3*p1 + 2*p2)) + exp(p1*(p3*y2 - p16 + p4*y3))*(p3*p13*y3*(y4 + y5)*(p2*p3*y2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2*p4*y3*exp(2*p1*(p3*y2 - p16 + p4*y3))) - p3*p13*p15*y3*(y4 + y5)*(p2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 3*p1*p3*y2 + p1*p4*y3 + p1^2*p3^2*y2^2 + p1^2*p3*p4*y2*y3 + 1)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
d2fdxdpval(:,3,2,4) = -(exp(2*p1*(p3*y2 - p16 + p4*y3))*(p3*p13*y3*(y4 + y5)*(p1^2*p3^2*p4*y2^2*y3 + 2*p1^2*p3*p4^2*y2*y3^2 + p1^2*p4^3*y3^3 - p1*p3^2*y2^2 + p1*p4^2*y3^2 - p3*y2 + p4*y3) - p3*p13*p15*y3*(y4 + y5)*(- p2*p1^2*p4^2*y3^2 - p2*p3*y2*p1^2*p4*y3 + 3*p2*p1*p4*y3 + p2*p3*y2*p1 + 2*p2)) - exp(p1*(p3*y2 - p16 + p4*y3))*(p3*p13*y3*(y4 + y5)*(p2*p3*y2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2*p4*y3*exp(2*p1*(p3*y2 - p16 + p4*y3))) + p3*p13*p15*y3*(y4 + y5)*(p2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p1*p3*y2 + 3*p1*p4*y3 + p1^2*p4^2*y3^2 + p1^2*p3*p4*y2*y3 + 1)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
d2fdxdpval(:,4,2,4) =  (exp(2*p1*(p3*y2 - p16 + p4*y3))*(p3*p13*p14*y3*y4*(p1^2*p3^3*y2^3 + 3*p1^2*p3^2*p4*y2^2*y3 + 3*p1^2*p3*p4^2*y2*y3^2 + p1^2*p4^3*y3^3) - p3*p13*p14*p15*y3*y4*(- p2*p1^2*p3^2*y2^2 - 2*p2*p1^2*p3*p4*y2*y3 - p2*p1^2*p4^2*y3^2 + 4*p2*p1*p3*y2 + 4*p2*p1*p4*y3 + 4*p2)) - p3*p13*p14*p15*y3*y4*exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 4*p1*p3*y2 + 4*p1*p4*y3 + p1^2*p3^2*y2^2 + p1^2*p4^2*y3^2 + 2*p1^2*p3*p4*y2*y3 + 2))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
0

% y3-p4
0
d2fdxdpval(:,2,3,4) = -(exp(2*p1*(p3*y2 - p16 + p4*y3))*(p3*p13*y2*(y4 + y5)*(p1^2*p3^2*p4*y2^2*y3 + 2*p1^2*p3*p4^2*y2*y3^2 + p1^2*p4^3*y3^3 - p1*p3^2*y2^2 + p1*p4^2*y3^2 - p3*y2 + p4*y3) - p3*p13*p15*y2*(y4 + y5)*(- p2*p1^2*p4^2*y3^2 - p2*p3*y2*p1^2*p4*y3 + 3*p2*p1*p4*y3 + p2*p3*y2*p1 + 2*p2)) - exp(p1*(p3*y2 - p16 + p4*y3))*(p3*p13*y2*(y4 + y5)*(p2*p3*y2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2*p4*y3*exp(2*p1*(p3*y2 - p16 + p4*y3))) + p3*p13*p15*y2*(y4 + y5)*(p2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p1*p3*y2 + 3*p1*p4*y3 + p1^2*p4^2*y3^2 + p1^2*p3*p4*y2*y3 + 1)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
d2fdxdpval(:,3,3,4) = -(p13*(y4 + y5)*(p15^2 + 3*p2^2*p15^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p2^3*p15^2*exp(3*p1*(p3*y2 - p16 + p4*y3)) + p3^2*y2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p2*p3^2*y2^2*exp(3*p1*(p3*y2 - p16 + p4*y3)) - p1*p4^3*y3^3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p1^2*p4^4*y3^4*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 4*p2*p3*p15*y2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - 2*p2*p4*p15*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p3*p4*y2*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 2*p2^2*p3*p15*y2*exp(3*p1*(p3*y2 - p16 + p4*y3)) - p2^2*p4*p15*y3*exp(3*p1*(p3*y2 - p16 + p4*y3)) - 5*p1*p2*p4^2*p15*y3^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - 4*p1*p3*p4^2*y2*y3^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - 3*p1*p3^2*p4*y2^2*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p1^2*p3^2*p4^2*y2^2*y3^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2*p3*p4*y2*y3*exp(3*p1*(p3*y2 - p16 + p4*y3)) + p1^2*p2*p4^3*p15*y3^3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 2*p1^2*p3*p4^3*y2*y3^3*exp(2*p1*(p3*y2 - p16 + p4*y3)) - 3*p1*p2*p3*p4*p15*y2*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p1^2*p2*p3*p4^2*p15*y2*y3^2*exp(2*p1*(p3*y2 - p16 + p4*y3))) - p13*exp(p1*(p3*y2 - p16 + p4*y3))*(y4 + y5)*(p1^2*p4^3*p15*y3^3 + p3*y2*p1^2*p4^2*p15*y3^2 + 5*p1*p4^2*p15*y3^2 + 3*p3*y2*p1*p4*p15*y3 + p4*p15*y3 - 3*p2*p15^2 - 2*p3*y2*p15))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
d2fdxdpval(:,4,3,4) =  (p13*p14*y4*(p15^2 + 3*p2^2*p15^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p2^3*p15^2*exp(3*p1*(p3*y2 - p16 + p4*y3)) - p1*p3^3*y2^3*exp(2*p1*(p3*y2 - p16 + p4*y3)) - p1*p4^3*y3^3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p1^2*p4^4*y3^4*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 2*p2*p3*p15*y2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - 2*p2*p4*p15*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p2^2*p3*p15*y2*exp(3*p1*(p3*y2 - p16 + p4*y3)) - p2^2*p4*p15*y3*exp(3*p1*(p3*y2 - p16 + p4*y3)) - p1*p2*p3^2*p15*y2^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - 5*p1*p2*p4^2*p15*y3^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - 3*p1*p3*p4^2*y2*y3^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) - 3*p1*p3^2*p4*y2^2*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 3*p1^2*p3^2*p4^2*y2^2*y3^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p1^2*p2*p4^3*p15*y3^3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 3*p1^2*p3*p4^3*y2*y3^3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p1^2*p3^3*p4*y2^3*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)) - 6*p1*p2*p3*p4*p15*y2*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)) + 2*p1^2*p2*p3*p4^2*p15*y2*y3^2*exp(2*p1*(p3*y2 - p16 + p4*y3)) + p1^2*p2*p3^2*p4*p15*y2^2*y3*exp(2*p1*(p3*y2 - p16 + p4*y3))) - p13*p14*y4*exp(p1*(p3*y2 - p16 + p4*y3))*(p1^2*p3^2*p4*p15*y2^2*y3 + 2*p1^2*p3*p4^2*p15*y2*y3^2 + p1^2*p4^3*p15*y3^3 + p1*p3^2*p15*y2^2 + 6*p1*p3*p4*p15*y2*y3 + 5*p1*p4^2*p15*y3^2 - p3*p15*y2 + p4*p15*y3 - 3*p2*p15^2))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
0

% y4-p4
0
d2fdxdpval(:,2,4,4) =  (p3*p13*y2*(y3/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))) + (p1*y3*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(p2 + exp(-p1*(p3*y2 - p16 + p4*y3)))^2)))/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^2; 
d2fdxdpval(:,3,4,4) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2*p13*p15*y3 + p3*p13*y3*(y2 - p1*p4*y2*y3) - p1*p4^2*p13*y3^3) + p13*p15*y3*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1) + p2*p3*p13*y2*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
d2fdxdpval(:,4,4,4) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(p13*p14*y3*(p1*p3^2*y2^2 + 2*p1*p3*p4*y2*y3 + p1*p4^2*y3^2) - 2*p2*p13*p14*p15*y3) - p13*p14*p15*y3*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
0

% y5-p4
0
d2fdxdpval(:,2,5,4) = (p3*p13*y2*(y3/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))) + (p1*y3*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(p2 + exp(-p1*(p3*y2 - p16 + p4*y3)))^2)))/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^2; 
d2fdxdpval(:,3,5,4) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(2*p2*p13*p15*y3 + p3*p13*y3*(y2 - p1*p4*y2*y3) - p1*p4^2*p13*y3^3) + p13*p15*y3*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1) + p2*p3*p13*y2*y3*exp(2*p1*(p3*y2 - p16 + p4*y3)))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
0
0



% y1-p5
0
0
0
0
0

% y2-p5
0
0
0
0
0

% y3-p5
0
0
0
0
0

% y4-p5
0
0
0
0
0

% y5-p5
0
0
0
0
0



% y1-p6
d2fdxdpval(:,1,1,6) = -1;
0
0
0
0

% y2-p6
0
d2fdxdpval(:,2,2,6) = -1;
0
0
0

% y3-p6
0
0
d2fdxdpval(:,3,3,6) = -1;
0
0

% y4-p6
0
0
0
d2fdxdpval(:,4,4,6) = -1;
0

% y5-p6
0
0
0
0
d2fdxdpval(:,5,5,6) = -1;



% y1-p7
0
0
0
0
0

% y2-p7
0
0
0
0
0

% y3-p7
0
0
0
0
0

% y4-p7
0
0
0
d2fdxdpval(:,4,4,7) = -1;
0

% y5-p7
0
0
0
0
d2fdxdpval(:,5,5,7) = -1;



% y1-p8
0
0
0
0
0

% y2-p8
0
0
0
0
0

% y3-p8
0
0
0
0
0

% y4-p8
0
0
0
d2fdxdpval(:,5,4,8) = -1;
d2fdxdpval(:,5,4,8) =  1;

% y5-p8
0
0
0
0
0



% y1-p9
0
d2fdxdpval(:,1,1,9) = (p10*p12*y2)/(p10 + y1)^2;
d2fdxdpval(:,2,1,9) = (p11*p12*y3)/(p11 + y1)^2;
0
0

% y2-p9
0
d2fdxdpval(:,2,2,9) = p12*y1)/(p10 + y1);
0
0
0

% y3-p9
0
0
d2fdxdpval(:,3,3,9) = (p12*y1)/(p11 + y1);
0
0

% y4-p9
0
0
0
0
0

% y5-p9
0
0
0
0
0



% y1-p10
d2fdxdpval(:,1,1,10) =  (p12*y2*(p10 - y1))/(p10 + y1)^3;
d2fdxdpval(:,2,1,10) = -(p9*p12*y2*(p10 - y1))/(p10 + y1)^3;
0
0
0

% y2-p10
d2fdxdpval(:,1,2,10) =  (p12*y1)/(p10 + y1)^2;
d2fdxdpval(:,2,2,10) = -(p9*p12*y1)/(p10 + y1)^2;
0
0
0

% y3-p10
0
0
0
0
0

% y4-p10
0
0
0
0
0

% y5-p10
0
0
0
0
0



% y1-p11
d2fdxdpval(:,1,1,11) =  (p12*y3*(p11 - y1))/(p11 + y1)^3;
0
d2fdxdpval(:,3,1,11) = -(p9*p12*y3*(p11 - y1))/(p11 + y1)^3;
0
0

% y2-p11
0
0
0
0
0

% y3-p11
d2fdxdpval(:,1,3,11) = (p12*y1)/(p11 + y1)^2;
0
d2fdxdpval(:,3,3,11) = -(p9*p12*y1)/(p11 + y1)^2;
0
0

% y4-p11
0
0
0
0
0

% y5-p11
0
0
0
0
0



% y1-p12
d2fdxdpval(:,1,1,12) = -(p10*y2)/(p10 + y1)^2 - (p11*(y3*p10^2 + 2*y3*p10*y1 + y3*y1^2))/((p10 + y1)^2*(p11 + y1)^2);
d2fdxdpval(:,2,1,12) =  (p9*p10*y2)/(p10 + y1)^2; 
d2fdxdpval(:,3,1,12) =  (p9*p11*y3)/(p11 + y1)^2;
0
0

% y2-p12
d2fdxdpval(:,1,2,12) = -y1/(p10 + y1); 
d2fdxdpval(:,2,2,12) =  (p9*y1)/(p10 + y1);
0
0
0

% y3-p12
d2fdxdpval(:,1,3,12) = -y1/(p11 + y1);
0 
d2fdxdpval(:,3,3,12) = (p9*y1)/(p11 + y1);
0

% y4-p12
0
0
0
0
0

% y5-p12
0
0
0
0
0



% y1-p13
0
0
0
0
0

% y2-p13
0
d2fdxdpval(:,2,2,13) = -(p3*p15*(y4 + y5)*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1) - exp(p1*(p3*y2 - p16 + p4*y3))*(p3*(y4 + y5)*(p1*p3^2*y2^2 + p1*p4*y3*p3*y2 - p4*y3) - 2*p2*p3*p15*(y4 + y5)) + p2*p3*p4*y3*exp(2*p1*(p3*y2 - p16 + p4*y3))*(y4 + y5))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2; 
d2fdxdpval(:,3,2,13) =  (p4*y3*(y4 + y5)*(p3/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))) + (p1*p3*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(p2 + exp(-p1*(p3*y2 - p16 + p4*y3)))^2)))/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^2;
d2fdxdpval(:,4,2,13) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(p3*p14*y4*(p1*p3^2*y2^2 + 2*p1*p3*p4*y2*y3 + p1*p4^2*y3^2) - 2*p2*p3*p14*p15*y4) - p3*p14*p15*y4*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
0

% y3-p13
0
d2fdxdpval(:,2,3,13) =  (p3*y2*(y4 + y5)*(p4/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))) + (p1*p4*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(p2 + exp(-p1*(p3*y2 - p16 + p4*y3)))^2)))/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^2;
d2fdxdpval(:,3,3,13) = -(p4*p15*(y4 + y5)*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1) - exp(p1*(p3*y2 - p16 + p4*y3))*(p4*(y4 + y5)*(p1*p4^2*y3^2 + p1*p3*y2*p4*y3 - p3*y2) - 2*p2*p4*p15*(y4 + y5)) + p2*p3*p4*y2*exp(2*p1*(p3*y2 - p16 + p4*y3))*(y4 + y5))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2; 
d2fdxdpval(:,4,3,13) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(p4*p14*y4*(p1*p3^2*y2^2 + 2*p1*p3*p4*y2*y3 + p1*p4^2*y3^2) - 2*p2*p4*p14*p15*y4) - p4*p14*p15*y4*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
0

% y4-p13
0
d2fdxdpval(:,2,4,13) =   p3*y2)/(p15 + (p3*y2 + p4*y3)/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))));
d2fdxdpval(:,3,4,13) = -(p4*y3)/(p15 + (p3*y2 + p4*y3)/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))));
d2fdxdpval(:,4,4,13) =  (p14*(p3*y2 + p4*y3))/(p15 + (p3*y2 + p4*y3)/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))));
0

% y5-p13
0
d2fdxdpval(:,2,5,13) = -(p3*y2)/(p15 + (p3*y2 + p4*y3)/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3)))); 
d2fdxdpval(:,3,5,13) = -(p4*y3)/(p15 + (p3*y2 + p4*y3)/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))));
0
0



% y1-p14
0
0
0
0
0

% y2-p14
0
0
0
d2fdxdpval(:,4,2,14) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(p3*p13*y4*(p1*p3^2*y2^2 + 2*p1*p3*p4*y2*y3 + p1*p4^2*y3^2) - 2*p2*p3*p13*p15*y4) - p3*p13*p15*y4*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
0

% y3-p14
0
0
0
d2fdxdpval(:,4,3,14) = -(exp(p1*(p3*y2 - p16 + p4*y3))*(p4*p13*y4*(p1*p3^2*y2^2 + 2*p1*p3*p4*y2*y3 + p1*p4^2*y3^2) - 2*p2*p4*p13*p15*y4) - p4*p13*p15*y4*(exp(2*p1*(p3*y2 - p16 + p4*y3))*p2^2 + 1))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^2;
0

% y4-p14
0
0
0
d2fdxdpval(:,4,4,14) = (p13*(p3*y2 + p4*y3))/(p15 + (p3*y2 + p4*y3)/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))));
0

% y5-p14
0
0
0
0
0



% y1-p15
0
0
0
0
0

% y2-p15
0
d2fdxdpval(:,2,2,15) =  ((p3*p13*(y4 + y5)*(p2^2*p15 + p15/exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2*p3*y2 + p2*p4*y3) - p2*p3*p13*(y4 + y5)*(p3*y2 - 2*p2*p15 - p4*y3 + 2*p1*p3^2*y2^2 + 2*p1*p3*p4*y2*y3))/exp(p1*(p3*y2 - p16 + p4*y3)) + p2*p3*p13*(y4 + y5)*(p2^2*p15 + p15/exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2*p3*y2 + p2*p4*y3) - (p3*p13*(y4 + y5)*(p3*y2 - 2*p2*p15 - p4*y3 + 2*p1*p3^2*y2^2 + 2*p1*p3*p4*y2*y3))/exp(2*p1*(p3*y2 - p16 + p4*y3)))/(p2*p15 + p3*y2 + p4*y3 + p15/exp(p1*(p3*y2 - p16 + p4*y3)))^3;
d2fdxdpval(:,3,2,15) = -(2*p4*p13*y3*(y4 + y5)*(p3/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))) + (p1*p3*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(p2 + exp(-p1*(p3*y2 - p16 + p4*y3)))^2)))/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^3; 
d2fdxdpval(:,4,2,15) = -((p3*p13*p14*y4*(p2^2*p15 + p15/exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2*p3*y2 - p2*p4*y3) - p2*p3*p13*p14*y4*(2*p1*p3^2*y2^2 + 4*p1*p3*p4*y2*y3 + p3*y2 + 2*p1*p4^2*y3^2 + p4*y3 - 2*p2*p15))/exp(p1*(p3*y2 - p16 + p4*y3)) + p2*p3*p13*p14*y4*(p2^2*p15 + p15/exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2*p3*y2 - p2*p4*y3) - (p3*p13*p14*y4*(2*p1*p3^2*y2^2 + 4*p1*p3*p4*y2*y3 + p3*y2 + 2*p1*p4^2*y3^2 + p4*y3 - 2*p2*p15))/exp(2*p1*(p3*y2 - p16 + p4*y3)))/(p2*p15 + p3*y2 + p4*y3 + p15/exp(p1*(p3*y2 - p16 + p4*y3)))^3;
0

% y3-p15
0
d2fdxdpval(:,2,3,15) = -(2*p3*p13*y2*(y4 + y5)*(p4/(p2 + 1/exp(p1*(p3*y2 - p16 + p4*y3))) + (p1*p4*(p3*y2 + p4*y3))/(exp(p1*(p3*y2 - p16 + p4*y3))*(p2 + exp(-p1*(p3*y2 - p16 + p4*y3)))^2)))/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^3;
d2fdxdpval(:,3,3,15) =  ((p4*p13*(y4 + y5)*(p2^2*p15 + p15/exp(2*p1*(p3*y2 - p16 + p4*y3)) + p2*p3*y2 - p2*p4*y3) - p2*p4*p13*(y4 + y5)*(p4*y3 - p3*y2 - 2*p2*p15 + 2*p1*p4^2*y3^2 + 2*p1*p3*p4*y2*y3))/exp(p1*(p3*y2 - p16 + p4*y3)) + p2*p4*p13*(y4 + y5)*(p2^2*p15 + p15/exp(2*p1*(p3*y2 - p16 + p4*y3)) + p2*p3*y2 - p2*p4*y3) - (p4*p13*(y4 + y5)*(p4*y3 - p3*y2 - 2*p2*p15 + 2*p1*p4^2*y3^2 + 2*p1*p3*p4*y2*y3))/exp(2*p1*(p3*y2 - p16 + p4*y3)))/(p2*p15 + p3*y2 + p4*y3 + p15/exp(p1*(p3*y2 - p16 + p4*y3)))^3; 
d2fdxdpval(:,4,3,15) = -((p4*p13*p14*y4*(p2^2*p15 + p15/exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2*p3*y2 - p2*p4*y3) - p2*p4*p13*p14*y4*(2*p1*p3^2*y2^2 + 4*p1*p3*p4*y2*y3 + p3*y2 + 2*p1*p4^2*y3^2 + p4*y3 - 2*p2*p15))/exp(p1*(p3*y2 - p16 + p4*y3)) + p2*p4*p13*p14*y4*(p2^2*p15 + p15/exp(2*p1*(p3*y2 - p16 + p4*y3)) - p2*p3*y2 - p2*p4*y3) - (p4*p13*p14*y4*(2*p1*p3^2*y2^2 + 4*p1*p3*p4*y2*y3 + p3*y2 + 2*p1*p4^2*y3^2 + p4*y3 - 2*p2*p15))/exp(2*p1*(p3*y2 - p16 + p4*y3)))/(p2*p15 + p3*y2 + p4*y3 + p15/exp(p1*(p3*y2 - p16 + p4*y3)))^3;
0

% y4-p15
0
d2fdxdpval(:,2,4,15) =  (p3*p13*y2)/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^2;
d2fdxdpval(:,3,4,15) =  (p4*p13*y3)/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^2;
d2fdxdpval(:,4,4,15) = -(p13*p14*(p3*y2 + p4*y3))/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^2;
0

% y5-p15
0
d2fdxdpval(:,2,5,15) = (p3*p13*y2)/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^2;
d2fdxdpval(:,3,5,15) = (p4*p13*y3)/(p15 + (p3*y2 + p4*y3)/(p2 + exp(-p1*(p3*y2 - p16 + p4*y3))))^2;
0
0



% y1-p16
0
0
0
0
0

% y2-p16
0
d2fdxdpval(:,2,2,16) = (exp(2*p1*(p3*y2 - p16 + p4*y3))*(p1*p3*p13*(y4 + y5)*(p1*p3^3*y2^3 + 2*p1*p3^2*p4*y2^2*y3 + p1*p3*p4^2*y2*y3^2 - p3*p4*y2*y3 - p4^2*y3^2) - p1*p3*p13*p15*(y4 + y5)*(2*p2*p3*y2 + p2*p4*y3 - p1*p2*p3^2*y2^2 - p1*p2*p3*p4*y2*y3)) - p1*p3*p13*p15*exp(p1*(p3*y2 - p16 + p4*y3))*(y4 + y5)*(2*p3*y2 + p4*y3 + p1*p3^2*y2^2 + p1*p3*p4*y2*y3))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
d2fdxdpval(:,3,2,16) = (exp(2*p1*(p3*y2 - p16 + p4*y3))*(p1*p3*p4*p13*y3*(y4 + y5)*(p1*p3^2*y2^2 + 2*p1*p3*p4*y2*y3 + p3*y2 + p1*p4^2*y3^2 + p4*y3) + p1*p3*p4*p13*p15*y3*(y4 + y5)*(p1*p2*p3*y2 - p2 + p1*p2*p4*y3)) - p1*p3*p4*p13*p15*y3*exp(p1*(p3*y2 - p16 + p4*y3))*(y4 + y5)*(p1*p3*y2 + p1*p4*y3 + 1))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3; 
d2fdxdpval(:,4,2,16) = -(exp(2*p1*(p3*y2 - p16 + p4*y3))*(p1*p3*p13*p14*y4*(p3*y2 + p4*y3)*(p1*p3^2*y2^2 + 2*p1*p3*p4*y2*y3 + p1*p4^2*y3^2) + p1*p3*p13*p14*p15*y4*(p3*y2 + p4*y3)*(p1*p2*p3*y2 - 2*p2 + p1*p2*p4*y3)) - p1*p3*p13*p14*p15*y4*exp(p1*(p3*y2 - p16 + p4*y3))*(p3*y2 + p4*y3)*(p1*p3*y2 + p1*p4*y3 + 2))/(p15 + p2*p15*exp(p1*(p3*y2 - p16 + p4*y3)) + p3*y2*exp(p1*(p3*y2 - p16 + p4*y3)) + p4*y3*exp(p1*(p3*y2 - p16 + p4*y3)))^3;
0

% y3-p16
0
d2fdxdpval(:,2,3,16) =  (exp(2.*p1.*(p3.*y2 - p16 + p4.*y3)).*(p1.*p3.*p4.*p13.*y2.*(y4 + y5).*(p1.*p3.^2.*y2.^2 + 2.*p1.*p3.*p4.*y2.*y3 + p3.*y2 + p1.*p4.^2.*y3.^2 + p4.*y3) + p1.*p3.*p4.*p13.*p15.*y2.*(y4 + y5).*(p1.*p2.*p3.*y2 - p2 + p1.*p2.*p4.*y3)) - p1.*p3.*p4.*p13.*p15.*y2.*exp(p1.*(p3.*y2 - p16 + p4.*y3)).*(y4 + y5).*(p1.*p3.*y2 + p1.*p4.*y3 + 1))./(p15 + p2.*p15.*exp(p1.*(p3.*y2 - p16 + p4.*y3)) + p3.*y2.*exp(p1.*(p3.*y2 - p16 + p4.*y3)) + p4.*y3.*exp(p1.*(p3.*y2 - p16 + p4.*y3))).^3;
d2fdxdpval(:,3,3,16) =  (exp(2.*p1.*(p3.*y2 - p16 + p4.*y3)).*(p1.*p4.*p13.*(y4 + y5).*(p1.*p3.^2.*p4.*y2.^2.*y3 - p3.^2.*y2.^2 + 2.*p1.*p3.*p4.^2.*y2.*y3.^2 - p3.*p4.*y2.*y3 + p1.*p4.^3.*y3.^3) - p1.*p4.*p13.*p15.*(y4 + y5).*(p2.*p3.*y2 + 2.*p2.*p4.*y3 - p1.*p2.*p4.^2.*y3.^2 - p1.*p2.*p3.*p4.*y2.*y3)) - p1.*p4.*p13.*p15.*exp(p1.*(p3.*y2 - p16 + p4.*y3)).*(y4 + y5).*(p3.*y2 + 2.*p4.*y3 + p1.*p4.^2.*y3.^2 + p1.*p3.*p4.*y2.*y3))./(p15 + p2.*p15.*exp(p1.*(p3.*y2 - p16 + p4.*y3)) + p3.*y2.*exp(p1.*(p3.*y2 - p16 + p4.*y3)) + p4.*y3.*exp(p1.*(p3.*y2 - p16 + p4.*y3))).^3;
d2fdxdpval(:,4,3,16) = -(exp(2.*p1.*(p3.*y2 - p16 + p4.*y3)).*(p1.*p4.*p13.*p14.*y4.*(p3.*y2 + p4.*y3).*(p1.*p3.^2.*y2.^2 + 2.*p1.*p3.*p4.*y2.*y3 + p1.*p4.^2.*y3.^2) + p1.*p4.*p13.*p14.*p15.*y4.*(p3.*y2 + p4.*y3).*(p1.*p2.*p3.*y2 - 2.*p2 + p1.*p2.*p4.*y3)) - p1.*p4.*p13.*p14.*p15.*y4.*exp(p1.*(p3.*y2 - p16 + p4.*y3)).*(p3.*y2 + p4.*y3).*(p1.*p3.*y2 + p1.*p4.*y3 + 2))./(p15 + p2.*p15.*exp(p1.*(p3.*y2 - p16 + p4.*y3)) + p3.*y2.*exp(p1.*(p3.*y2 - p16 + p4.*y3)) + p4.*y3.*exp(p1.*(p3.*y2 - p16 + p4.*y3))).^3; 
0

% y4-p16
0
d2fdxdpval(:,2,4,16) = -(p1.*p3.*p13.*y2.*(p3.*y2 + p4.*y3))./(exp(p1.*(p3.*y2 - p16 + p4.*y3)).*(p15 + (p3.*y2 + p4.*y3)./(p2 + exp(-p1.*(p3.*y2 - p16 + p4.*y3)))).^2.*(p2 + exp(-p1.*(p3.*y2 - p16 + p4.*y3))).^2); 
d2fdxdpval(:,3,4,16) = -(p1.*p4.*p13.*y3.*(p3.*y2 + p4.*y3))./(exp(p1.*(p3.*y2 - p16 + p4.*y3)).*(p15 + (p3.*y2 + p4.*y3)./(p2 + exp(-p1.*(p3.*y2 - p16 + p4.*y3)))).^2.*(p2 + exp(-p1.*(p3.*y2 - p16 + p4.*y3))).^2); 
d2fdxdpval(:,4,4,16) =  (p1.*p13.*p14.*(p3.*y2 + p4.*y3).^2)./(exp(p1.*(p3.*y2 - p16 + p4.*y3)).*(p15 + (p3.*y2 + p4.*y3)./(p2 + exp(-p1.*(p3.*y2 - p16 + p4.*y3)))).^2.*(p2 + exp(-p1.*(p3.*y2 - p16 + p4.*y3))).^2);
0

% y5-p16
0
d2fdxdpval(:,2,5,16) = -(p1.*p3.*p13.*y2.*(p3.*y2 + p4.*y3))./(exp(p1.*(p3.*y2 - p16 + p4.*y3)).*(p15 + (p3.*y2 + p4.*y3)./(p2 + exp(-p1.*(p3.*y2 - p16 + p4.*y3)))).^2.*(p2 + exp(-p1.*(p3.*y2 - p16 + p4.*y3))).^2); 
d2fdxdpval(:,3,5,16) = -(p1.*p4.*p13.*y3.*(p3.*y2 + p4.*y3))./(exp(p1.*(p3.*y2 - p16 + p4.*y3)).*(p15 + (p3.*y2 + p4.*y3)./(p2 + exp(-p1.*(p3.*y2 - p16 + p4.*y3)))).^2.*(p2 + exp(-p1.*(p3.*y2 - p16 + p4.*y3))).^2); 
0
0

