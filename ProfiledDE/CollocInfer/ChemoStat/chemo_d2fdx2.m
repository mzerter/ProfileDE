function d2fdx2val = chemo_d2fdx2(times, y, p, more)

[nt, ny] = size(y);

p       = exp(p);

p3  = p(3);
p4  = p(4);
% p5  = p(5);
p6  = p(6);
% p7  = p(7);
% p8  = p(8);
p9  = p(9);
p10 = p(10);
p11 = p(11);
p12 = p(12);
p13 = p(13);
p14 = p(14);
p15 = p(15);
p16 = p(16);

y1 = y(:,1);
y2 = y(:,2);
y3 = y(:,3);
% y4 = y(:,4);
y5 = y(:,5);

% R       = p3*y2 + p4*y3 - p16;
p10py1  = p10 + y1;
p11py1  = p11 + y1;
% y4py5   = y4  + y5;
% 
% E1 = exp(100*R);
% E2 = exp( 200*p16 - 200*p3*y2 - 200*p4*y3);
% E3 = exp(-200*p16 + 200*p3*y2 + 200*p4*y3);
% E4 = exp(-300*p16 + 300*p3*y2 + 300*p4*y3);
% E5 = exp( 400*p16 - 400*p3*y2 - 400*p4*y3);
% E6 = exp( 300*p16 - 300*p3*y2 - 300*p4*y3);
% E7 = exp(100*p3*y2);
% E8 = exp(100*p4*y3);
% E9 = exp(100*p16);
E10 = exp(100*p3*y2 - 100*p16 + 100*p4*y3);
E11 = exp(200*p3*y2 - 200*p16 + 200*p4*y3);
E12 = exp(300*p3*y2 - 300*p16 + 300*p4*y3);
E13 = exp(400*p3*y2 - 400*p16 + 400*p4*y3);
% E14 = exp(50*p3*y2 - 50*p16 + 50*p4*y3);
% E15 = exp(100*p16 - 100*p3*y2 - 100*p4*y3);
E10p1 = E10 + 1;

d2fdx2val = zeros(nt,ny,ny,ny);

% y1-y1
d2fdx2val(:,1,1,1) =  (2*p12*y2)/( p10py1)^2 + ...
    (2*p12*y3)/( p11py1)^2 - (2*p12*y1*y2)/( p10py1)^3 - ...
    (2*p12*y1*y3)/( p11py1)^3;
d2fdx2val(:,2,1,1) = -(2*p10*p12*p9*y2)/p10py1^3;
d2fdx2val(:,3,1,1) = -(2*p11*p12*p9*y3)/p11py1^3;

% y2-y1
d2fdx2val(:,1,2,1) = -(p10*p12)/p10py1^2;
d2fdx2val(:,2,2,1) =  (p10*p12*p9)/p10py1^2;

% y3-y1
d2fdx2val(:,1,3,1) = -(p11*p12)/( p11py1)^2;
d2fdx2val(:,3,3,1) =  (p11*p12*p9)/( p11py1)^2;

% y1-y2
d2fdx2val(:,1,1,2) = -(p10*p12)/p10py1^2;
d2fdx2val(:,2,1,2) =  (p10*p12*p9)/p10py1^2;

% y2-y2
d2fdx2val(:,2,2,2) = (2*p13*p3*(p6 + y5)*((p3*E10)/E10p1 - ...
    (100*p16*p3*E10)/E10p1^2 + ...
    (100*p3*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (100*p3*E11*(p3*y2 + p4*y3))/E10p1^2))/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^2 - ...
    (2*p13*p3*y2*(p6 + y5)*((p3*E10)/E10p1 - ...
    (100*p16*p3*E10)/E10p1^2 + ...
    (100*p3*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (100*p3*E11*(p3*y2 + p4*y3))/E10p1^2)^2)/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^3 + ...
    (p13*p3*y2*(p6 + y5)*((200*p3^2*E10)/E10p1 - ...
    (200*p3^2*E11)/E10p1^2 + ...
    (10000*p3^2*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (30000*p3^2*E11*(p3*y2 + p4*y3))/E10p1^2 + ...
    (20000*p3^2*E12*(p3*y2 + p4*y3))/E10p1^3 - ...
    (10000*p16*p3^2*E10)/E10p1^2 + ...
    (20000*p16*p3^2*E11)/E10p1^3))/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^2;
d2fdx2val(:,3,2,2) = (p13*p4*y3*(p6 + y5)*((200*p3^2*E10)/E10p1 - ...
    (200*p3^2*E11)/E10p1^2 + ...
    (10000*p3^2*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (30000*p3^2*E11*(p3*y2 + p4*y3))/E10p1^2 + ...
    (20000*p3^2*E12*(p3*y2 + p4*y3))/E10p1^3 - ...
    (10000*p16*p3^2*E10)/E10p1^2 + ...
    (20000*p16*p3^2*E11)/E10p1^3))/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^2 - ...
    (2*p13*p4*y3*(p6 + y5)*((p3*E10)/E10p1 - ...
    (100*p16*p3*E10)/E10p1^2 + ...
    (100*p3*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (100*p3*E11*(p3*y2 + p4*y3))/E10p1^2)^2)/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^3;
d2fdx2val(:,4,2,2) = (2*p13*p14*p6*(p3*y2 + p4*y3)*((p3*E10)/E10p1 - ...
    (100*p16*p3*E10)/E10p1^2 + ...
    (100*p3*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (100*p3*E11*(p3*y2 + p4*y3))/E10p1^2)^2)/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^3 - ...
    (2*p13*p14*p3*p6*((p3*E10)/E10p1 - ...
    (100*p16*p3*E10)/E10p1^2 + (100*p3*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (100*p3*E11*(p3*y2 + p4*y3))/E10p1^2))/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^2 - ...
    (p13*p14*p6*(p3*y2 + p4*y3)*((200*p3^2*E10)/E10p1 - ...
    (200*p3^2*E11)/E10p1^2 + ...
    (10000*p3^2*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (30000*p3^2*E11*(p3*y2 + p4*y3))/E10p1^2 + ...
    (20000*p3^2*E12*(p3*y2 + p4*y3))/E10p1^3 - ...
    (10000*p16*p3^2*E10)/E10p1^2 + ...
    (20000*p16*p3^2*E11)/E10p1^3))/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^2;
%  y3-y2
d2fdx2val(:,2,3,2) = (p13*p3*(p6 + y5)*((p4*E10)/E10p1 - ...
    (100*p16*p4*E10)/E10p1^2 + ...
    (100*p4*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (100*p4*E11*(p3*y2 + p4*y3))/E10p1^2))/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^2 + ...
    (p13*p3*y2*(p6 + y5)*((200*p3*p4*E10)/E10p1 - ...
    (200*p3*p4*E11)/E10p1^2 + ...
    (10000*p3*p4*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (30000*p3*p4*E11*(p3*y2 + p4*y3))/E10p1^2 + ...
    (20000*p3*p4*E12*(p3*y2 + p4*y3))/E10p1^3 - ...
    (10000*p16*p3*p4*E10)/E10p1^2 + ...
    (20000*p16*p3*p4*E11)/E10p1^3))/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^2 - ...
    (2*p13*p3*y2*(p6 + y5)*((p3*E10)/E10p1 - ...
    (100*p16*p3*E10)/E10p1^2 + ...
    (100*p3*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (100*p3*E11*(p3*y2 + p4*y3))/E10p1^2)*((p4*E10)/E10p1 - ...
    (100*p16*p4*E10)/E10p1^2 + ...
    (100*p4*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (100*p4*E11*(p3*y2 + p4*y3))/E10p1^2))/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^3;
d2fdx2val(:,3,3,2) = (p13*p4*(p6 + y5)*((p3*E10)/E10p1 - ...
    (100*p16*p3*E10)/E10p1^2 + ...
    (100*p3*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (100*p3*E11*(p3*y2 + p4*y3))/E10p1^2))/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^2 + ...
    (p13*p4*y3*(p6 + y5)*((200*p3*p4*E10)/E10p1 - ...
    (200*p3*p4*E11)/E10p1^2 + ...
    (10000*p3*p4*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (30000*p3*p4*E11*(p3*y2 + p4*y3))/E10p1^2 + ...
    (20000*p3*p4*E12*(p3*y2 + p4*y3))/E10p1^3 - ...
    (10000*p16*p3*p4*E10)/E10p1^2 + ...
    (20000*p16*p3*p4*E11)/E10p1^3))/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^2 - ...
    (2*p13*p4*y3*(p6 + y5)*((p3*E10)/E10p1 - ...
    (100*p16*p3*E10)/E10p1^2 + ...
    (100*p3*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (100*p3*E11*(p3*y2 + p4*y3))/E10p1^2)*((p4*E10)/E10p1 - ...
    (100*p16*p4*E10)/E10p1^2 + ...
    (100*p4*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (100*p4*E11*(p3*y2 + p4*y3))/E10p1^2))/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^3;
d2fdx2val(:,4,3,2) = -(2*p13*p14*p3*p4*p6*(3*p15*E11 - ...
    100*p16^2*E11 + 2*p16*E11 + 3*p15*E12 + p16*E12 + p15*E13 - ...
    5000*p3^3*y2^3*E11 - 10000*p3^3*y2^3*E12 - 5000*p4^3*y3^3*E11 - ...
    10000*p4^3*y3^3*E12 - 200*p15*p16*E11 - 100*p15*p16*E12 - ...
    5000*p16^2*p3*y2*E11 - 5000*p16^2*p4*y3*E11 + ...
    10000*p16*p3^2*y2^2*E11 + 15000*p15*p3^2*y2^2*E12 + ...
    20000*p16*p3^2*y2^2*E12 + 10000*p16*p4^2*y3^2*E11 + ...
    15000*p15*p4^2*y3^2*E12 + 20000*p16*p4^2*y3^2*E12 + ...
    400*p15*p3*y2*E11 + 300*p16*p3*y2*E11 + 600*p15*p3*y2*E12 + ...
    300*p16*p3*y2*E12 + 400*p15*p4*y3*E11 + 300*p16*p4*y3*E11 + ...
    600*p15*p4*y3*E12 + 300*p16*p4*y3*E12 - 15000*p3*p4^2*y2*y3^2*E11 - ...
    15000*p3^2*p4*y2^2*y3*E11 - 30000*p3*p4^2*y2*y3^2*E12 - ...
    30000*p3^2*p4*y2^2*y3*E12 - 5000*p15*p16*p3*y2*E12 - ...
    5000*p15*p16*p4*y3*E12 + 20000*p16*p3*p4*y2*y3*E11 + ...
    30000*p15*p3*p4*y2*y3*E12 + ...
    40000*p16*p3*p4*y2*y3*E12))/(E10p1*(p15 + p16 + p15*E10 + ...
    p3*y2*E10 + p4*y3*E10)^3) - ...
    (2*p13*p14*p3*p4*p6*E10*(p15 + p16 - 100*p15*p16 - 100*p16^2 - ...
    5000*p16^2*p3*y2 - 5000*p16^2*p4*y3 + 5000*p3^3*y2^3*E11 + ...
    5000*p4^3*y3^3*E11 + 5000*p15*p3^2*y2^2 + 5000*p16*p3^2*y2^2 + ...
    5000*p15*p4^2*y3^2 + 5000*p16*p4^2*y3^2 + 200*p15*p3*y2 + ...
    200*p16*p3*y2 + 200*p15*p4*y3 + 200*p16*p4*y3 - ...
    5000*p15*p16*p3*y2 - 5000*p15*p16*p4*y3 - 20000*p15*p3^2*y2^2*E11 - ...
    15000*p16*p3^2*y2^2*E11 - 20000*p15*p4^2*y3^2*E11 - ...
    15000*p16*p4^2*y3^2*E11 - 400*p15*p3*y2*E11 - 200*p16*p3*y2*E11 - ...
    400*p15*p4*y3*E11 - 200*p16*p4*y3*E11 + 15000*p3*p4^2*y2*y3^2*E11 + ...
    15000*p3^2*p4*y2^2*y3*E11 + 10000*p15*p16*p3*y2*E11 + ...
    10000*p15*p16*p4*y3*E11 + 10000*p15*p3*p4*y2*y3 + ...
    10000*p16*p3*p4*y2*y3 - 40000*p15*p3*p4*y2*y3*E11 - ...
    30000*p16*p3*p4*y2*y3*E11))/(E10p1* ...
    (p15 + p16 + p15*E10 + p3*y2*E10 + p4*y3*E10)^3);

% y5-y2
d2fdx2val(:,2,5,2) = -(E10*(p13*p3*(p16 - 100*p3^2*y2^2 + p4*y3 + ...
    100*p16*p3*y2 - 100*p3*p4*y2*y3) + 2*p13*p15*p3) + ...
    p13*p3*(p16 + p4*y3*E11) + p13*p15*p3*(E11 + 1))/ ...
    (p15 + p16 + p15*E10 + p3*y2*E10 + p4*y3*E10)^2;
d2fdx2val(:,3,5,2) = (p13*p4*y3*((p3*E10)/E10p1 + ...
    (100*p3*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (100*p3*E11*(p3*y2 + p4*y3))/E10p1^2) - ...
    (100*p13*p16*p3*p4*y3*E10)/E10p1^2)/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^2;

% y1-y3
d2fdx2val(:,1,1,3) = -(p11*p12)/p11py1^2;
d2fdx2val(:,3,1,3) =  (p11*p12*p9)/p11py1^2;

% y2-y3
d2fdx2val(:,2,2,3) = d2fdx2val(2,3,2);
d2fdx2val(:,3,2,3) = d2fdx2val(3,3,2);
d2fdx2val(:,4,2,3) = d2fdx2val(4,3,2);

% y3-y3
d2fdx2val(:,2,3,3) = (p13*p3*y2*(p6 + y5)*((200*p4^2*E10)/E10p1 - ...
    (200*p4^2*E11)/E10p1^2 + ...
    (10000*p4^2*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (30000*p4^2*E11*(p3*y2 + p4*y3))/E10p1^2 + ...
    (20000*p4^2*E12*(p3*y2 + p4*y3))/E10p1^3 - ...
    (10000*p16*p4^2*E10)/E10p1^2 + ...
    (20000*p16*p4^2*E11)/E10p1^3))/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^2 - ...
    (2*p13*p3*y2*(p6 + y5)*((p4*E10)/E10p1 - ...
    (100*p16*p4*E10)/E10p1^2 + ...
    (100*p4*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (100*p4*E11*(p3*y2 + p4*y3))/E10p1^2)^2)/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^3;
d2fdx2val(:,3,3,3) = (2*p13*p4*(p6 + y5)*((p4*E10)/E10p1 - ...
    (100*p16*p4*E10)/E10p1^2 + ...
    (100*p4*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (100*p4*E11*(p3*y2 + p4*y3))/E10p1^2))/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^2 - ...
    (2*p13*p4*y3*(p6 + y5)*((p4*E10)/E10p1 - ...
    (100*p16*p4*E10)/E10p1^2 + ...
    (100*p4*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (100*p4*E11*(p3*y2 + p4*y3))/E10p1^2)^2)/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^3 + ...
    (p13*p4*y3*(p6 + y5)*((200*p4^2*E10)/E10p1 - ...
    (200*p4^2*E11)/E10p1^2 + ...
    (10000*p4^2*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (30000*p4^2*E11*(p3*y2 + p4*y3))/E10p1^2 + ...
    (20000*p4^2*E12*(p3*y2 + p4*y3))/E10p1^3 - ...
    (10000*p16*p4^2*E10)/E10p1^2 + ...
    (20000*p16*p4^2*E11)/E10p1^3))/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^2;
d2fdx2val(:,4,3,3) = (2*p13*p14*p6*(p3*y2 + p4*y3)*((p4*E10)/E10p1 - ...
    (100*p16*p4*E10)/E10p1^2 + ...
    (100*p4*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (100*p4*E11*(p3*y2 + p4*y3))/E10p1^2)^2)/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^3 - ...
    (2*p13*p14*p4*p6*((p4*E10)/E10p1 - ...
    (100*p16*p4*E10)/E10p1^2 + ...
    (100*p4*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (100*p4*E11*(p3*y2 + p4*y3))/E10p1^2))/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^2 - ...
    (p13*p14*p6*(p3*y2 + p4*y3)*((200*p4^2*E10)/E10p1 - ...
    (200*p4^2*E11)/E10p1^2 + ...
    (10000*p4^2*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (30000*p4^2*E11*(p3*y2 + p4*y3))/E10p1^2 + ...
    (20000*p4^2*E12*(p3*y2 + p4*y3))/E10p1^3 - ...
    (10000*p16*p4^2*E10)/E10p1^2 + ...
    (20000*p16*p4^2*E11)/E10p1^3))/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^2;


% y5-y3
d2fdx2val(:,2,5,3) = (p13*p3*y2*((p4*E10)/E10p1 + ...
    (100*p4*E10*(p3*y2 + p4*y3))/E10p1 - ...
    (100*p4*E11*(p3*y2 + p4*y3))/E10p1^2) - ...
    (100*p13*p16*p3*p4*y2*E10)/E10p1^2)/(p15 + p16/E10p1 + ...
    (E10*(p3*y2 + p4*y3))/E10p1)^2;
d2fdx2val(:,3,5,3) = -(E10*(p13*p4*(p16 - 100*p4^2*y3^2 + p3*y2 + ...
    100*p16*p4*y3 - 100*p3*p4*y2*y3) + 2*p13*p15*p4) + ...
    p13*p4*(p16 + p3*y2*E11) + p13*p15*p4*(E11 + 1))/ ...
    (p15 + p16 + p15*E10 + p3*y2*E10 + p4*y3*E10)^2;


% y2-y5
d2fdx2val(:,2,2,5) = d2fdx2val(:,2,5,2);
d2fdx2val(:,3,2,5) = d2fdx2val(:,3,5,2);

% y3-y5
d2fdx2val(:,2,3,5) = d2fdx2val(:,2,5,3);
d2fdx2val(:,3,3,5) = d2fdx2val(:,3,5,3);


end

